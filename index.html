<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LUMOS | Action Guide</title>
    <!-- Pretendard í°íŠ¸ (ê°€ì¥ í˜„ëŒ€ì ì¸ í•œê¸€ í°íŠ¸) -->
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" />
    <style>
        /* --- 1. ëª¨ë˜ ë””ìì¸ ì‹œìŠ¤í…œ (Design System) --- */
        :root {
            /* Color Palette: Modern Sage */
            --primary: #4A6E5D;        /* ì°¨ë¶„í•œ ë”¥ ê·¸ë¦° */
            --primary-light: #EBF2EF;  /* ì•„ì£¼ ì—°í•œ ë¯¼íŠ¸ ê·¸ë ˆì´ */
            --secondary: #D4A373;      /* í¬ì¸íŠ¸: ë”°ëœ»í•œ ìƒŒë“œ ë² ì´ì§€ */
            --bg-base: #F5F7F6;        /* ë°°ê²½: ì›œ ì¿¨ ê·¸ë ˆì´ */

            /* Mission Lights Colors */
            --light-off: #E0E0E0;
            --light-on-1: #FFB74D;     /* ì£¼í™©ë¹› (ì†ŒìŠ¤) */
            --light-on-2: #4DB6AC;     /* ë¯¼íŠ¸ë¹› (ì§„ë‹¨) */
            --light-on-3: #FF8A65;     /* ì½”ë„ë¹› (ì…íšŒ) */

            --surface: #FFFFFF;
            --surface-trans: rgba(255, 255, 255, 0.85);

            --text-title: #2C3531;
            --text-body: #586661;
            --text-caption: #8D9995;

            /* Shadows & Radius */
            --shadow-sm: 0 2px 8px rgba(74, 110, 93, 0.06);
            --shadow-md: 0 12px 24px rgba(74, 110, 93, 0.08), 0 4px 8px rgba(74, 110, 93, 0.04);
            --shadow-float: 0 20px 40px rgba(74, 110, 93, 0.15);

            /* Glow Effects */
            --glow-1: 0 0 15px rgba(255, 183, 77, 0.6);
            --glow-2: 0 0 15px rgba(77, 182, 172, 0.6);
            --glow-3: 0 0 20px rgba(255, 138, 101, 0.8);

            --radius-lg: 28px;
            --radius-md: 20px;
            --radius-sm: 14px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Pretendard', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: #EEF1F0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            color: var(--text-title);
        }

        /* ì•± ì»¨í…Œì´ë„ˆ (ìŠ¤ë§ˆíŠ¸í° í™”ë©´) */
        .app-container {
            width: 100%;
            max-width: 420px;
            height: 100%;
            max-height: 880px;
            background: var(--bg-base);
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 50px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
        }

        /* ë°ìŠ¤í¬íƒ‘ì—ì„œë§Œ íœ´ëŒ€í° í”„ë ˆì„ íš¨ê³¼ */
        @media (min-width: 500px) {
            .app-container {
                border-radius: 40px;
                border: 12px solid #1a1a1a;
            }

            /* ìƒë‹¨ ë…¸ì¹˜ íš¨ê³¼ */
            .app-container::before {
                content: '';
                position: absolute;
                top: 0;
                left: 50%;
                transform: translateX(-50%);
                width: 150px;
                height: 25px;
                background: #1a1a1a;
                border-radius: 0 0 20px 20px;
                z-index: 1000;
                pointer-events: none;
            }
        }

        /* --- ìƒë‹¨ í—¤ë” --- */
        .header {
            padding: 24px 24px 10px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: transparent;
            z-index: 10;
        }

        .profile-wrap {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, #769F8B 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
            box-shadow: var(--shadow-sm);
        }

        .user-info h1 { font-size: 18px; font-weight: 700; color: var(--text-title); }
        .user-info p { font-size: 13px; color: var(--text-caption); font-weight: 500; }

        .noti-btn {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            background: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            cursor: pointer;
            box-shadow: var(--shadow-sm);
            position: relative;
        }
        .noti-badge {
            position: absolute;
            top: 10px; right: 10px;
            width: 6px; height: 6px;
            background: #FF5252;
            border-radius: 50%;
        }

        /* --- ì½˜í…ì¸  ì˜ì—­ (ìŠ¤í¬ë¡¤) --- */
        .content-area {
            flex: 1;
            overflow-y: auto;
            padding: 10px 24px 40px 24px;
            scroll-behavior: smooth;
        }

        /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€ */
        .content-area::-webkit-scrollbar { display: none; }

        /* ì„¹ì…˜ íƒ€ì´í‹€ */
        .section-title {
            font-size: 19px;
            font-weight: 700;
            margin: 30px 0 16px 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .section-title span.more {
            font-size: 13px;
            color: var(--text-caption);
            font-weight: 500;
        }

        /* --- [NEW] ì˜¤ëŠ˜ì˜ ë¯¸ì…˜ ëŒ€ì‹œë³´ë“œ --- */
        .mission-dashboard {
            background: var(--surface);
            border-radius: var(--radius-md);
            padding: 16px 20px;
            box-shadow: var(--shadow-sm);
            margin-bottom: 24px;
            position: relative;
            overflow: hidden;
        }

        .mission-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .mission-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-title);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .mission-total-pt {
            background: var(--primary-light);
            color: var(--primary);
            font-size: 12px;
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 12px;
        }

        .mission-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
            position: relative;
            z-index: 1;
        }

        .mission-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            gap: 4px;
            position: relative;
        }

        /* ë¶ˆë¹› (Light) ìŠ¤íƒ€ì¼ */
        .light-indicator {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            background: var(--light-off);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            font-weight: 700;
            color: #999;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            border: 3px solid #F5F7F6;
            line-height: 1.2;
        }

        .mission-item.on .light-indicator {
            transform: scale(1.05);
            color: white;
            border-color: white;
        }

        .mission-item.on:nth-child(1) .light-indicator { background: var(--light-on-1); box-shadow: var(--glow-1); }
        .mission-item.on:nth-child(2) .light-indicator { background: var(--light-on-2); box-shadow: var(--glow-2); }
        .mission-item.on:nth-child(3) .light-indicator { background: var(--light-on-3); box-shadow: var(--glow-3); }

        .mission-reward {
            font-size: 10px;
            font-weight: 700;
            color: var(--primary);
            background: rgba(74, 110, 93, 0.1);
            padding: 2px 6px;
            border-radius: 6px;
        }

        .mission-footer {
            margin-top: 12px;
            text-align: center;
            font-size: 11px;
            color: var(--text-caption);
            font-weight: 500;
            background: #FAFAFA;
            padding: 6px;
            border-radius: 8px;
        }

        .bonus-highlight {
            color: var(--secondary);
            font-weight: 700;
        }

        /* --- [NEW] ë§ˆì´í˜ì´ì§€ ì„±ê³¼ ì¹´ë“œ --- */
        .performance-card {
            background: var(--surface);
            border-radius: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            padding: 24px;
            position: relative;
            overflow: hidden;
        }

        .deco-coin {
            position: absolute;
            font-size: 48px;
            opacity: 0.12;
            filter: blur(2px);
            pointer-events: none;
        }
        .deco-coin.top-left { top: -8px; left: -8px; }
        .deco-coin.bottom-right { bottom: -8px; right: -8px; }

        .mypage-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            position: relative;
        }

        .mypage-avatar {
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, var(--primary) 0%, #5A8F7B 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            flex-shrink: 0;
        }

        .mypage-user-info {
            flex: 1;
        }

        .mypage-user-info h1 {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-title);
            margin: 0 0 4px 0;
        }

        .mypage-user-info p {
            font-size: 13px;
            color: var(--text-caption);
            margin: 0;
        }

        .perf-refresh-inline {
            width: 36px;
            height: 36px;
            background: var(--bg);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: var(--text-caption);
            cursor: pointer;
            transition: all 0.2s;
        }
        .perf-refresh-inline:active {
            transform: rotate(180deg);
            background: #E8F5E9;
            color: var(--primary);
        }

        .perf-list {
            display: flex;
            flex-direction: column;
            gap: 0;
        }

        .perf-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid #F0F0F0;
            cursor: pointer;
            transition: background 0.2s;
        }
        .perf-item:last-child { border-bottom: none; }
        .perf-item:active { background: #FAFAFA; margin: 0 -24px; padding: 16px 24px; }

        .perf-label {
            font-size: 15px;
            font-weight: 500;
            color: var(--text-title);
        }

        .perf-value-wrap {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .perf-value {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-body);
        }

        .perf-value.highlight {
            font-size: 20px;
            font-weight: 800;
            color: #FF8F00;
        }

        .perf-arrow {
            font-size: 18px;
            color: #BDBDBD;
            font-weight: 300;
        }

        /* í¬ì¸íŠ¸ ì ë¦½ ê¸°ì¤€ ì˜ì—­ */
        .perf-info {
            border-top: 1px dashed #E0E0E0;
            margin-top: 16px;
            padding-top: 16px;
        }

        .perf-info-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-title);
            margin-bottom: 12px;
        }

        .perf-info-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .perf-info-item {
            display: flex;
            justify-content: space-between;
            font-size: 13px;
            color: var(--text-body);
        }

        .perf-info-item.highlight {
            color: var(--primary);
            font-weight: 600;
        }

        /* í¬ì¸íŠ¸ ì‚¬ìš©ì²˜ ì•ˆë‚´ */
        .perf-usage-msg {
            border-top: 1px dashed #E0E0E0;
            margin-top: 16px;
            padding-top: 16px;
            text-align: center;
            font-size: 13px;
            color: var(--primary);
            font-weight: 500;
        }

        .perf-usage-msg .underline {
            text-decoration: underline;
            font-weight: 600;
        }

        /* --- 1. Bento Grid ëŒ€ì‹œë³´ë“œ --- */
        .bento-grid {
            display: grid;
            /* 3ê°œì˜ ì»¬ëŸ¼ì„ í•œ ì¤„ë¡œ ë°°ì¹˜ (ë¹„ìœ¨ì¡°ì •: ì²«ë²ˆì§¸ ì¹¸ì„ ì•½ê°„ ë„“ê²Œ 1.4 : 1 : 1) */
            grid-template-columns: 1.4fr 1fr 1fr;
            gap: 8px; /* ê°„ê²©ì„ 10px -> 8pxë¡œ ì¢í˜€ ê³µê°„ í™•ë³´ */
            width: 100%;
        }

        .bento-card {
            background: var(--surface);
            border-radius: var(--radius-md);
            padding: 14px; /* ë‚´ë¶€ ì—¬ë°± ìµœì í™” */
            box-shadow: var(--shadow-sm);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
            height: 105px; /* ë†’ì´ ê³ ì • */
        }

        .bento-card:active { transform: scale(0.96); }

        .bento-large {
            /* grid-column ì†ì„± ì œê±° (í•œ ì¹¸ë§Œ ì°¨ì§€) */
            background: linear-gradient(120deg, var(--primary) 0%, #355043 100%);
            color: white;
            position: relative;
            overflow: hidden;
        }

        .bento-large::after {
            content: '';
            position: absolute;
            right: -25px; bottom: -25px;
            width: 70px; height: 70px; /* ì¥ì‹ ì› í¬ê¸° ì¶•ì†Œ */
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
        }

        /* ì¢ì€ ê³µê°„ì„ ìœ„í•œ í°íŠ¸ ì¡°ì • */
        .stat-label { font-size: 11px; font-weight: 500; opacity: 0.85; margin-bottom: 2px; white-space: nowrap; }
        .stat-value { font-size: 22px; font-weight: 800; line-height: 1.1; letter-spacing: -0.5px; }
        .stat-sub { font-size: 11px; opacity: 0.8; margin-top: auto; }

        /* --- [NEW] ì˜¤ëŠ˜ì˜ ì¼ì • (Compact & Clean) --- */
        .schedule-block {
            background: var(--surface);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            padding: 0 16px;
            margin-top: 10px;
        }

        .schedule-row {
            display: flex;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #F0F0F0;
            min-height: 44px;
        }

        .schedule-row:last-child {
            border-bottom: none;
        }

        .time-badge {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-caption);
            width: 90px;
            flex-shrink: 0;
        }

        .status-divider {
            width: 1px;
            height: 14px;
            background-color: #E0E0E0;
            margin: 0 12px;
        }

        .content-wrap {
            flex: 1;
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 6px;
        }

        .task-text {
            font-size: 14px;
            color: var(--text-title);
            font-weight: 500;
            line-height: 1.2;
        }

        .task-sub {
            font-size: 12px;
            color: var(--text-caption);
            margin-top: 0;
        }

        /* ë¹ˆ ì¼ì • ê°•ì¡° ìŠ¤íƒ€ì¼ */
        .task-text-free {
            color: var(--primary);
            font-weight: 800;
            font-size: 14px;
        }

        .task-sub-free {
            color: var(--primary);
            font-weight: 700;
            font-size: 13px;
        }

        /* --- [NEW] 3ê°œ ë²„íŠ¼ ê°€ë¡œ 1í–‰ 3ì—´ ë©”ë‰´ --- */
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* 3ì—´ ê°€ë¡œ ë°°ì¹˜ */
            gap: 10px;
            margin-top: 16px;
            margin-bottom: 20px;
        }

        .menu-card {
            background: var(--surface);
            border-radius: var(--radius-md);
            padding: 14px 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
            box-shadow: var(--shadow-sm);
            cursor: pointer;
            transition: all 0.2s;
            min-height: 80px;
            text-align: center;
        }

        .menu-card:active { transform: scale(0.96); }

        .menu-icon { font-size: 22px; margin-bottom: 0; }
        .menu-title { font-size: 12px; font-weight: 700; color: var(--text-title); line-height: 1.3; }

        /* ê°•ì¡° ìŠ¤íƒ€ì¼ (AI í™œë™ ì¶”ì²œ) */
        .menu-card.highlight {
            background: var(--primary);
            color: white;
            box-shadow: 0 8px 20px rgba(74, 110, 93, 0.3);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .menu-card.highlight .menu-title { color: white; }

        /* --- 3. ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ (ì¶”ì²œ ì¥ì†Œ) --- */
        .place-card {
            background: var(--surface);
            border-radius: var(--radius-md);
            padding: 18px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 16px;
            box-shadow: var(--shadow-sm);
        }

        .place-img {
            width: 56px; height: 56px;
            border-radius: 16px;
            background-color: #F0F0F0;
            display: flex; align-items: center; justify-content: center;
            font-size: 24px;
        }

        .place-info { flex: 1; }
        .place-name { font-size: 16px; font-weight: 700; color: var(--text-title); margin-bottom: 4px; }
        .place-time { font-size: 13px; color: var(--secondary); font-weight: 600; display: flex; align-items: center; gap: 4px; }

        .btn-go {
            width: 40px; height: 40px;
            border-radius: 50%;
            border: 1px solid #eee;
            background: white;
            color: var(--primary);
            display: flex; align-items: center; justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 600;
            font-size: 13px;
        }

        .btn-go:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(74, 110, 93, 0.3);
        }

        .btn-go:active {
            transform: scale(0.95);
        }

        /* --- ì¥ì†Œ ìƒì„¸ í˜ì´ì§€ ì´ë¯¸ì§€ ì˜ì—­ (Full-width) --- */
        .place-image-full {
            width: calc(100% + 48px);
            margin-left: -24px;
            margin-right: -24px;
            height: 220px;
            background: linear-gradient(135deg, #E8F5E9, #C8E6C9);
            border-radius: 0;
            margin-bottom: 24px;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-md);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* ì§€ë„ ìœ„ í•€ ë§ˆì»¤ */
        .map-pin {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -80%);
            font-size: 48px;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
            animation: pinBounce 1s ease-in-out infinite;
            z-index: 10;
        }

        @keyframes pinBounce {
            0%, 100% { transform: translate(-50%, -80%); }
            50% { transform: translate(-50%, -90%); }
        }

        /* ê³µí†µ ë’¤ë¡œê°€ê¸° ë²„íŠ¼ */
        .back-btn-common {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.85) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            font-weight: 500;
            color: var(--text-title);
            box-shadow: 0 2px 12px rgba(0,0,0,0.08), 0 1px 3px rgba(0,0,0,0.06);
            transition: all 0.2s ease;
            border: 1px solid rgba(0,0,0,0.04);
            flex-shrink: 0;
        }

        .back-btn-common:active {
            transform: scale(0.92);
            background: linear-gradient(135deg, rgba(240,240,240,0.95) 0%, rgba(235,235,235,0.85) 100%);
        }

        .back-btn-common::before {
            content: 'â€¹';
            font-size: 26px;
            font-weight: 300;
            line-height: 1;
            margin-top: -2px;
        }

        /* ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ í…ìŠ¤íŠ¸ hover íš¨ê³¼ */
        .nav-text-item:hover {
            background: var(--primary-light);
        }

        .nav-text-item.active {
            background: var(--primary-light);
        }

        /* í˜ì´ì§€ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ */
        .page { display: none; animation: fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .page.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* í•«ìŠ¤íŒŸ ì‹¤ì‹œê°„ ê°•ì¡° ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes shimmer {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        @keyframes iconGlow {
            0%, 100% {
                text-shadow: 0 0 10px rgba(255, 152, 0, 0.6),
                             0 0 20px rgba(255, 152, 0, 0.4);
            }
            50% {
                text-shadow: 0 0 20px rgba(255, 152, 0, 0.9),
                             0 0 30px rgba(255, 152, 0, 0.6),
                             0 0 40px rgba(255, 152, 0, 0.3);
            }
        }

        /* í•«ìŠ¤íŒŸ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .hotspot-card {
            background: linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 50%, #FFCC80 100%);
            background-size: 200% 200%;
            animation: shimmer 3s ease-in-out infinite;
            border: 2px solid #FF9800;
            box-shadow: 0 8px 24px rgba(255, 152, 0, 0.3),
                        0 0 0 1px rgba(255, 152, 0, 0.1) inset;
            position: relative;
            overflow: hidden;
        }

        .hotspot-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                45deg,
                transparent 30%,
                rgba(255, 255, 255, 0.3) 50%,
                transparent 70%
            );
            animation: shimmer 2s linear infinite;
        }

        .hotspot-icon {
            animation: pulse 2s ease-in-out infinite, iconGlow 2s ease-in-out infinite;
        }

        .hotspot-text {
            animation: blink 1.5s ease-in-out infinite;
            font-weight: 800;
            color: #E65100;
        }

        /* --- LUMI ì±—ë´‡ í—¤ë” --- */
        .lumi-chat-header {
            position: sticky;
            top: -10px;
            margin: -10px -24px 0 -24px;
            padding: 16px 20px;
            background: var(--primary);
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 100;
        }

        .lumi-back-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: white;
            font-size: 18px;
            font-weight: 600;
            transition: background 0.2s;
        }

        .lumi-back-btn:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        .lumi-avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background-image: url('LUMI_front.png');
            background-size: cover;
            background-position: center;
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 15px rgba(255, 183, 77, 0.4);
        }

        .lumi-info {
            flex: 1;
        }

        .lumi-name {
            font-size: 17px;
            font-weight: 700;
            color: white;
        }

        .lumi-status {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            margin-top: 2px;
        }

        /* ì±—ë´‡ í˜ì´ì§€ ë ˆì´ì•„ì›ƒ (ë©”ì‹ ì € ìŠ¤íƒ€ì¼) */
        #page-chat {
            display: flex;
            flex-direction: column;
            padding: 0 !important;
            overflow: hidden;
        }

        #page-chat.active {
            display: flex;
        }

        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 16px;
            padding: 16px 20px;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .chat-bubble {
            max-width: 80%;
            padding: 14px 18px;
            font-size: 15px;
            line-height: 1.5;
            position: relative;
        }
        .bot {
            background: white;
            border-radius: 20px 20px 20px 4px;
            box-shadow: var(--shadow-sm);
            align-self: flex-start;
            color: var(--text-body);
        }
        .user {
            background: var(--primary);
            color: white;
            border-radius: 20px 20px 4px 20px;
            align-self: flex-end;
            box-shadow: 0 4px 12px rgba(74, 110, 93, 0.2);
        }

        /* ì„ íƒì§€ ì¹© ì˜ì—­ (ì…ë ¥ë°” ìœ„) */
        .quick-chips {
            display: flex;
            gap: 8px;
            padding: 12px 20px;
            overflow-x: auto;
            background: var(--bg-base);
            border-top: 1px solid #E8E8E8;
            flex-shrink: 0;
        }
        .quick-chips:empty {
            display: none;
            padding: 0;
            border: none;
        }
        .quick-chips::-webkit-scrollbar {
            display: none;
        }
        .chip {
            background: white;
            border: 1px solid rgba(74, 110, 93, 0.2);
            color: var(--primary);
            padding: 10px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
            flex-shrink: 0;
        }
        .chip:hover { background: var(--primary); color: white; border-color: transparent; }

        /* í•˜ë‹¨ ê³ ì • ì…ë ¥ ë°” */
        .chat-input-bar {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 16px;
            background: white;
            border-top: 1px solid #E8E8E8;
            flex-shrink: 0;
        }
        .chat-input-bar input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #E0E0E0;
            border-radius: 24px;
            font-size: 15px;
            font-family: inherit;
            outline: none;
            transition: border-color 0.2s;
        }
        .chat-input-bar input:focus {
            border-color: var(--primary);
        }
        .chat-input-bar .send-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: var(--primary);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.2s;
        }
        .chat-input-bar .send-btn:hover {
            background: #3D5C4D;
        }
        .chat-input-bar .send-btn:active {
            transform: scale(0.95);
        }
        .chat-input-bar .send-btn::before {
            content: 'â¤';
            color: white;
            font-size: 18px;
        }

        /* í™œë™ GO! ë²„íŠ¼ hover íš¨ê³¼ */
        .btn-sales-start:hover {
            background: var(--primary) !important;
            color: white !important;
        }

        /* --- ë°©ë¬¸ ê²°ê³¼ ìƒì„¸ í˜ì´ì§€ ìŠ¤íƒ€ì¼ --- */
        .visit-result-header {
            background: linear-gradient(135deg, var(--primary) 0%, #5D8A72 100%);
            margin: -10px -24px 20px -24px;
            padding: 24px;
            border-radius: 0 0 28px 28px;
            color: white;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .visit-result-header .place-icon {
            width: 48px;
            height: 48px;
            border-radius: 14px;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .visit-result-header .place-title {
            flex: 1;
            font-size: 18px;
            font-weight: 700;
        }

        .result-card {
            background: white;
            border-radius: var(--radius-md);
            padding: 20px;
            margin-bottom: 12px;
            box-shadow: var(--shadow-sm);
        }

        .result-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .result-card-label {
            font-size: 13px;
            color: var(--text-caption);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .result-card-edit {
            font-size: 13px;
            color: var(--primary);
            font-weight: 600;
            cursor: pointer;
            padding: 6px 12px;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .result-card-edit:hover {
            background: var(--primary-light);
        }

        .result-card-value {
            font-size: 16px;
            color: var(--text-title);
            font-weight: 600;
            line-height: 1.5;
        }

        .result-card-value.sub {
            font-size: 14px;
            color: var(--text-body);
            font-weight: 500;
        }

        /* ê²°ê³¼ ìƒíƒœ ë°°ì§€ */
        .result-status {
            display: inline-flex;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }

        .result-status.none {
            background: #F5F5F5;
            color: #9E9E9E;
        }

        .result-status.source {
            background: #E3F2FD;
            color: #1976D2;
        }

        .result-status.success {
            background: #E8F5E9;
            color: #2E7D32;
        }

        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: var(--radius-lg);
            padding: 24px;
            width: 100%;
            max-width: 360px;
            max-height: 80vh;
            overflow-y: auto;
            animation: modalIn 0.3s ease-out;
        }

        @keyframes modalIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* --- [ë­í‚¹] í˜ì´ì§€ ìŠ¤íƒ€ì¼ --- */
        /* Top 3 í¬ë””ì›€ */
        .ranking-podium {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            height: 260px;
            margin-bottom: 0;
            gap: 12px;
        }

        .podium-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        /* ìˆœìœ„ë³„ ë†’ì´ ë° ìŠ¤íƒ€ì¼ */
        .podium-1 { order: 2; z-index: 2; margin-bottom: 10px; }
        .podium-2 { order: 1; }
        .podium-3 { order: 3; }

        .rank-avatar {
            width: 50px; height: 50px;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: var(--shadow-sm);
            margin-bottom: -15px;
            z-index: 2;
            background-color: #ddd;
            display: flex; align-items: center; justify-content: center;
            font-size: 24px;
        }

        .podium-1 .rank-avatar { width: 64px; height: 64px; border-color: #FFD700; font-size: 30px; }

        .rank-box {
            width: 100px;
            border-radius: 12px 12px 0 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 20px;
            color: white;
            box-shadow: var(--shadow-md);
            position: relative;
        }

        .rank-box::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 100%;
            height: 20px;
            background: inherit;
            z-index: -1;
        }

        /* 1ë“± (ê³¨ë“œ) */
        .podium-1 .rank-box {
            height: 185px;
            background: linear-gradient(135deg, #FFD700 0%, #FDB931 100%);
        }
        /* 2ë“± (ì‹¤ë²„) */
        .podium-2 .rank-box {
            height: 155px;
            background: linear-gradient(135deg, #E0E0E0 0%, #BDBDBD 100%);
        }
        /* 3ë“± (ë¸Œë¡ ì¦ˆ) */
        .podium-3 .rank-box {
            height: 130px;
            background: linear-gradient(135deg, #CD7F32 0%, #A05A2C 100%);
        }

        .rank-num { font-size: 24px; font-weight: 800; text-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 4px; }
        .rank-name { font-size: 13px; font-weight: 700; margin-bottom: 2px; }
        .rank-group { font-size: 11px; opacity: 0.9; margin-bottom: 4px; text-align: center; }
        .rank-score { font-size: 16px; font-weight: 800; color: #fff; text-shadow: 0 1px 2px rgba(0,0,0,0.2); }

        .rank-crown { position: absolute; top: -30px; font-size: 32px; animation: crownFloat 2s infinite ease-in-out; }

        @keyframes crownFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        /* 4~10ìœ„ ë¦¬ìŠ¤íŠ¸ */
        .ranking-list {
            background: white;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
            padding: 10px 20px;
            position: relative;
            z-index: 10;
            margin-top: -10px;
        }

        .rank-row {
            display: flex;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        .rank-row:last-child { border-bottom: none; }

        .r-rank { font-size: 16px; font-weight: 700; color: var(--text-caption); width: 30px; text-align: center; }
        .r-info { flex: 1; margin-left: 12px; display: flex; align-items: center; gap: 6px; }
        .r-name { font-size: 15px; font-weight: 600; color: var(--text-title); }

        .r-group {
            font-size: 12px;
            color: var(--text-caption);
            margin-top: 0;
            padding-left: 6px;
            border-left: 1px solid #ddd;
            line-height: 1;
        }

        .r-score { font-size: 15px; font-weight: 700; color: var(--primary); }

        /* --- í”Œë¡œíŒ… ì±—ë´‡ ë²„íŠ¼ (LUMI) --- */
        .floating-chat-btn {
            position: absolute;
            bottom: 90px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-image: url('LUMI_front.png');
            background-size: cover;
            background-position: center;
            background-color: var(--primary);
            border: 3px solid white;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.25), 0 2px 8px rgba(74, 110, 93, 0.3);
            cursor: pointer;
            z-index: 100;
            animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .floating-chat-btn:hover {
            transform: scale(1.08);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3), 0 4px 12px rgba(74, 110, 93, 0.4);
        }

        .floating-chat-btn:active {
            transform: scale(0.95);
        }

        /* ì•Œë¦¼ ë±ƒì§€ (ë¹¨ê°„ ì ) */
        .floating-chat-btn::after {
            content: '';
            position: absolute;
            top: 2px;
            right: 2px;
            width: 14px;
            height: 14px;
            background: #FF5252;
            border-radius: 50%;
            border: 2px solid white;
            animation: badgePulse 2s ease-in-out infinite;
        }

        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3) translateY(50px);
            }
            50% {
                opacity: 1;
                transform: scale(1.1) translateY(-10px);
            }
            70% {
                transform: scale(0.95) translateY(5px);
            }
            100% {
                transform: scale(1) translateY(0);
            }
        }

        @keyframes badgePulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.8;
            }
        }

        /* --- [NEW] ì˜¤ëŠ˜ í™œë™ ì™„ë£Œ ë¦¬í¬íŠ¸ ì• ë‹ˆë©”ì´ì…˜ --- */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.6s ease-out forwards;
        }

        /* ì˜¤ëŠ˜ í™œë™ ì™„ë£Œ ë²„íŠ¼ */
        .btn-finish-daily {
            width: 100%;
            padding: 16px 24px;
            background: linear-gradient(135deg, #2C3E50 0%, #4A6E5D 100%);
            color: white;
            font-size: 16px;
            font-weight: 700;
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            margin-top: 16px;
            box-shadow: 0 4px 15px rgba(44, 62, 80, 0.3);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn-finish-daily:active {
            transform: scale(0.98);
            box-shadow: 0 2px 8px rgba(44, 62, 80, 0.3);
        }

        /* ë¦¬í¬íŠ¸ í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        #page-finish {
            background: white;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding: 60px 20px 40px 20px;
            min-height: 100%;
            z-index: 300;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            box-sizing: border-box;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-title);
            margin-bottom: 20px;
            text-align: center;
        }

        .modal-input-group {
            margin-bottom: 16px;
        }

        .modal-input-label {
            font-size: 13px;
            color: var(--text-caption);
            margin-bottom: 8px;
            display: block;
        }

        .modal-input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #E0E0E0;
            border-radius: 14px;
            font-size: 15px;
            font-family: inherit;
            transition: border-color 0.2s;
        }

        .modal-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .modal-textarea {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #E0E0E0;
            border-radius: 14px;
            font-size: 15px;
            font-family: inherit;
            min-height: 100px;
            resize: none;
            transition: border-color 0.2s;
        }

        .modal-textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 24px;
        }

        .modal-btn {
            flex: 1;
            padding: 14px;
            border-radius: 14px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
        }

        .modal-btn.cancel {
            background: #F5F5F5;
            color: var(--text-body);
        }

        .modal-btn.cancel:hover {
            background: #E0E0E0;
        }

        .modal-btn.save {
            background: var(--primary);
            color: white;
        }

        .modal-btn.save:hover {
            background: #3D5C4D;
        }

        /* ê²°ê³¼ ì„ íƒ ì˜µì…˜ */
        .result-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .result-option {
            padding: 16px;
            border: 2px solid #E0E0E0;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .result-option:hover {
            border-color: var(--primary);
            background: var(--primary-light);
        }

        .result-option.selected {
            border-color: var(--primary);
            background: var(--primary-light);
        }

        .result-option-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .result-option-text {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-title);
        }

        /* ë§ˆì´í˜ì´ì§€ ì´ë ¥ ì¹´ë“œ í´ë¦­ ê°€ëŠ¥ í‘œì‹œ */
        .history-card {
            cursor: pointer;
            transition: all 0.2s;
        }

        .history-card:hover {
            transform: translateX(4px);
            box-shadow: var(--shadow-md);
        }

        .history-card .arrow-icon {
            color: var(--text-caption);
            font-size: 16px;
            font-weight: 600;
        }

    </style>
</head>
<body>

<div class="app-container">

    <!-- ê³µí†µ í—¤ë” -->
    <header class="header" style="justify-content:space-between; padding:24px 20px 10px 20px;">
        <!-- ë’¤ë¡œê°€ê¸° ë²„íŠ¼ (ìƒì„¸ í˜ì´ì§€ì—ì„œë§Œ í‘œì‹œ) -->
        <div id="header-back-btn" class="back-btn-common" style="visibility:hidden;" onclick="goBack()"></div>
        <!-- ìƒë‹¨ í…ìŠ¤íŠ¸ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div style="display:flex; gap:8px; align-items:center;">
            <div class="nav-text-item active" onclick="goToPage('home')" style="font-size:14px; font-weight:600; color:var(--primary); cursor:pointer; padding:8px 12px; border-radius:8px; transition:all 0.2s;">í™ˆ</div>
            <span style="color:#E0E0E0;">|</span>
            <div class="nav-text-item" onclick="goToPage('mypage')" style="font-size:14px; font-weight:600; color:var(--text-caption); cursor:pointer; padding:8px 12px; border-radius:8px; transition:all 0.2s;">ë§ˆì´</div>
            <span style="color:#E0E0E0;">|</span>
            <div class="nav-text-item" onclick="goToPage('ranking')" style="font-size:14px; font-weight:600; color:var(--text-caption); cursor:pointer; padding:8px 12px; border-radius:8px; transition:all 0.2s;">ë­í‚¹</div>
        </div>
        <!-- ê· í˜•ì„ ìœ„í•œ ë¹ˆ ê³µê°„ -->
        <div style="width:40px;"></div>
    </header>

    <!-- 1. ë©”ì¸ í™ˆ (ëŒ€ì‹œë³´ë“œ) -->
    <div id="page-home" class="content-area page active">

        <!-- [NEW] ì˜¤ëŠ˜ì˜ ë¯¸ì…˜ ëŒ€ì‹œë³´ë“œ -->
        <div class="mission-dashboard" onclick="goToPage('ranking')" style="cursor:pointer;">
            <div class="mission-header">
                <div class="mission-title">
                    <span>ğŸ”¥ ì˜¤ëŠ˜ì˜ ë¯¸ì…˜</span>
                </div>
                <div class="mission-total-pt">+ 40P</div>
            </div>

            <div class="mission-grid">
                <!-- ë¯¸ì…˜ 1: ì‹ ê·œ ì†ŒìŠ¤ (ë‹¬ì„± ìƒíƒœ) -->
                <div class="mission-item on">
                    <div class="light-indicator">
                        <span>ì‹ ê·œ</span>
                        <span>ì†ŒìŠ¤</span>
                    </div>
                    <div class="mission-reward">+20P</div>
                </div>

                <!-- ë¯¸ì…˜ 2: ì‹ ê·œ ì§„ë‹¨ (ë‹¬ì„± ìƒíƒœ) -->
                <div class="mission-item on">
                    <div class="light-indicator">
                        <span>ì‹ ê·œ</span>
                        <span>ì§„ë‹¨</span>
                    </div>
                    <div class="mission-reward">+20P</div>
                </div>

                <!-- ë¯¸ì…˜ 3: ì…íšŒ (ë¯¸ë‹¬ì„± ìƒíƒœ) -->
                <div class="mission-item">
                    <div class="light-indicator">
                        <span>ì…íšŒ</span>
                    </div>
                    <div class="mission-reward">+50P</div>
                </div>
            </div>

            <div class="mission-footer">
                âœ¨ 3ê°œ ëª¨ë‘ ë‹¬ì„± ì‹œ <span class="bonus-highlight">100pt</span> ì¶”ê°€ ì§€ê¸‰
            </div>
        </div>

        <!-- ì§€ê¸ˆ ê°€ì•¼ í•  í•«ìŠ¤íŒŸ -->
        <div class="section-title">
            ì§€ê¸ˆ ê°€ì•¼ í•  í•«ìŠ¤íŒŸ
            <span class="more" onclick="goToPage('recommend')">ë”ë³´ê¸°</span>
        </div>

        <div id="hotspot-card" class="place-card hotspot-card" onclick="goToPage('recommend')">
            <div id="hotspot-icon" class="place-img hotspot-icon" style="background:linear-gradient(135deg, #FFE0B2, #FF9800); color:#E65100;">ğŸŒ²</div>
            <div class="place-info">
                <div id="hotspot-name" class="place-name" style="color:#E65100; font-weight:800;">íš¨ì›ê³µì›</div>
                <div class="place-time hotspot-text">âš¡ ì§€ê¸ˆ ìœ ë™ì¸êµ¬ ê¸‰ì¦ ì¤‘</div>
            </div>
            <div class="btn-go" style="background:#FF9800; color:white; border-color:#FF9800;">â”</div>
        </div>

        <!-- 3ê°œ ì£¼ìš” ê¸°ëŠ¥ ë²„íŠ¼ (ê°€ë¡œ 1í–‰ 3ì—´) -->
        <div class="menu-grid">
            <!-- 1. AI í™œë™ ì¶”ì²œ (ê°•ì¡°) -->
            <div class="menu-card highlight" onclick="goToPage('recommend')">
                <div class="menu-icon">ğŸš€</div>
                <div class="menu-title">AI í™œë™ ì¶”ì²œ</div>
            </div>

            <!-- 2. ì„±ê³¼ ë“±ë¡ -->
            <div class="menu-card" onclick="goToPage('chat')">
                <div class="menu-icon">ğŸ“</div>
                <div class="menu-title">ì„±ê³¼ ë“±ë¡</div>
            </div>

            <!-- 3. ì˜¤ëŠ˜ í™œë™ ì™„ë£Œ -->
            <div class="menu-card" onclick="showDailyReport()">
                <div class="menu-icon">âœ…</div>
                <div class="menu-title">ì˜¤ëŠ˜ í™œë™ ì™„ë£Œ</div>
            </div>
        </div>

        <!-- ì˜¤ëŠ˜ì˜ ì¼ì • -->
        <div class="section-title">
            ì˜¤ëŠ˜ì˜ ì¼ì •
        </div>

        <div class="schedule-block">
            <!-- 09:00 - 10:00 -->
            <div class="schedule-row">
                <span class="time-badge">09:00 - 10:00</span>
                <div class="status-divider"></div>
                <div class="task-info">
                    <span class="task-text">ì—…ë¬´ í™•ì¸ ë° ê¸°ì¡´ ê³ ê° ê´€ë¦¬</span>
                </div>
            </div>
            <!-- 10:00 - 11:00 -->
            <div class="schedule-row">
                <span class="time-badge">10:00 - 11:00</span>
                <div class="status-divider"></div>
                <div class="task-info">
                    <span class="task-text">ë¯¸íŒ… ë° êµìœ¡</span>
                </div>
            </div>
            <!-- 11:00 - 12:00 (ì˜ì—… ê°€ëŠ¥) -->
            <div class="schedule-row free" onclick="goToPage('recommend')" style="cursor:pointer;">
                <span class="time-badge">11:00 - 12:00</span>
                <div class="status-divider"></div>
                <div class="task-info">
                    <span class="task-text task-text-free">ì¼ì •ì—†ìŒ</span>
                    <span class="task-sub task-sub-free">âš¡ì˜ì—…ê°€ëŠ¥</span>
                </div>
            </div>
            <!-- 12:00 - 13:00 -->
            <div class="schedule-row">
                <span class="time-badge">12:00 - 13:00</span>
                <div class="status-divider"></div>
                <div class="task-info">
                    <span class="task-text">ì ì‹¬ ì‹œê°„</span>
                </div>
            </div>
            <!-- 13:00 - 14:00 -->
            <div class="schedule-row">
                <span class="time-badge">13:00 - 14:00</span>
                <div class="status-divider"></div>
                <div class="task-info">
                    <span class="task-text">ë‚˜ì›…ì§„ ê³ ê° ìƒë‹´</span>
                    <span class="task-sub">ğŸ“ ì‚¼ì„±1ì°¨</span>
                </div>
            </div>
            <!-- 14:00 - 15:00 (ì˜ì—… ê°€ëŠ¥) -->
            <div class="schedule-row free" onclick="goToPage('recommend')" style="cursor:pointer;">
                <span class="time-badge">14:00 - 15:00</span>
                <div class="status-divider"></div>
                <div class="task-info">
                    <span class="task-text task-text-free">ì¼ì •ì—†ìŒ</span>
                    <span class="task-sub task-sub-free">âš¡ì˜ì—…ê°€ëŠ¥</span>
                </div>
            </div>
            <!-- 15:00 - 17:00 -->
            <div class="schedule-row">
                <span class="time-badge">15:00 - 17:00</span>
                <div class="status-divider"></div>
                <div class="task-info">
                    <span class="task-text">íŒì´‰ í™œë™</span>
                    <span class="task-sub">ğŸ“ ê¿ˆë‚˜ë¬´ ì–´ë¦°ì´ì§‘</span>
                </div>
            </div>
            <!-- 17:00 - 18:00 -->
            <div class="schedule-row">
                <span class="time-badge">17:00 - 18:00</span>
                <div class="status-divider"></div>
                <div class="task-info">
                    <span class="task-text">ì—…ë¬´ ë§ˆë¬´ë¦¬</span>
                </div>
            </div>
        </div>

    </div>

    <!-- 2. AI ì¶”ì²œ í˜ì´ì§€ -->
    <div id="page-recommend" class="content-area page">
        <!-- í˜„ì¬ ìœ„ì¹˜ ì¹´ë“œ -->
        <div style="width:100%; background:white; border-radius:24px; margin-bottom:20px; position:relative; overflow:hidden; box-shadow:var(--shadow-sm);">
            <!-- ì§€ë„ ì´ë¯¸ì§€ -->
            <div style="width:100%; height:150px; position:relative;">
                <img src="ìˆ˜ì›ì‚¬ì—…êµ­_map.jpg" alt="í˜„ì¬ ìœ„ì¹˜ ì§€ë„" style="width:100%; height:100%; object-fit:cover;">
                <div class="map-pin" style="font-size:36px;">ğŸ“</div>
            </div>
            <!-- ìœ„ì¹˜ ì •ë³´ -->
            <div style="padding:16px;">
                <div style="display:flex; align-items:center; gap:12px; margin-bottom:10px;">
                    <div style="flex:1;">
                        <div style="font-size:11px; color:var(--primary); font-weight:600; margin-bottom:3px;">í˜„ì¬ ìœ„ì¹˜</div>
                        <div style="font-size:16px; font-weight:800; color:var(--text-title);">ìˆ˜ì›ì‚¬ì—…êµ­</div>
                    </div>
                    <div style="background:var(--primary); color:white; padding:6px 12px; border-radius:12px; font-size:11px; font-weight:700;">
                        ì¶œë°œì§€
                    </div>
                </div>
                <div style="background:var(--bg-base); padding:10px 14px; border-radius:14px; font-size:12px; color:var(--text-body); line-height:1.4;">
                    ğŸ“Œ ê²½ê¸° ìˆ˜ì›ì‹œ ì˜í†µêµ¬ íš¨ì›ë¡œ 400 (ë§¤íƒ„ë™) íƒ‘í”„ë¼ì 601í˜¸
                </div>
            </div>
        </div>

        <!-- ì£¼ë³€ ì¶”ì²œ ì¥ì†Œ íƒ€ì´í‹€ -->
        <div class="section-title" style="margin-top:0;">ğŸ“ ì£¼ë³€ ì¶”ì²œ ì¥ì†Œ</div>
        <div style="font-size:12px; color:var(--text-caption); margin-bottom:16px; margin-top:-10px; font-weight:500;">
            ë„ë³´ ê±°ë¦¬, ì¸ì› ìˆ˜ ê¸°ë°˜ ì¶”ì²œ ì¥ì†Œ
        </div>

        <!-- 1. íš¨ì›ê³µì› -->
        <div class="place-card" onclick="goToPlaceDetail('íš¨ì›ê³µì›')">
            <div class="place-img" style="background:#E8F5E9; color:#4CAF50;">ğŸŒ²</div>
            <div class="place-info">
                <div class="place-name">íš¨ì›ê³µì›</div>
                <div class="place-time">í•˜ì› í›„ ì—ë„ˆì§€ ë„˜ì¹˜ëŠ” ì•„ì´ë“¤ ì§‘ê²°</div>
            </div>
            <div class="btn-go">Go</div>
        </div>

        <!-- 2. íŒíƒ€ì§€ì›€ -->
        <div class="place-card" onclick="goToPlaceDetail('íŒíƒ€ì§€ì›€')">
            <div class="place-img" style="background:#FFF3E0; color:#FF9800;">ğŸ°</div>
            <div class="place-info">
                <div class="place-name">íŒíƒ€ì§€ì›€</div>
                <div class="place-time">ì†Œë¹„ë ¥ ë†’ì€ ì˜í†µ ë§˜ë“¤ì˜ ì„±ì§€</div>
            </div>
            <div class="btn-go">Go</div>
        </div>

        <!-- 3. ì•„ì´íŒŒí¬ ìºìŠ¬ 1ë‹¨ì§€ -->
        <div class="place-card" onclick="goToPlaceDetail('ì•„ì´íŒŒí¬ ìºìŠ¬')">
            <div class="place-img" style="background:#E3F2FD; color:#2196F3;">ğŸšŒ</div>
            <div class="place-info">
                <div class="place-name">ì•„ì´íŒŒí¬ ìºìŠ¬ 1ë‹¨ì§€</div>
                <div class="place-time">ì…”í‹€ë²„ìŠ¤ ì§‘ê²°ì§€, ë“±í•˜ì› ì‹œê°„ ìµœì </div>
            </div>
            <div class="btn-go">Go</div>
        </div>

        <!-- 4. ë§í¬ ê¸€ë¹› ë„ì„œê´€ -->
        <div class="place-card" onclick="goToPlaceDetail('ë§í¬ ê¸€ë¹› ë„ì„œê´€')">
            <div class="place-img" style="background:#F3E5F5; color:#9C27B0;">ğŸ“š</div>
            <div class="place-info">
                <div class="place-name">ë§í¬ ê¸€ë¹› ë„ì„œê´€</div>
                <div class="place-time">êµìœ¡ì—´ ë†’ì€ ë¶€ëª¨ë‹˜ ëŒ€í™” ê°€ëŠ¥</div>
            </div>
            <div class="btn-go">Go</div>
        </div>

        <!-- 5. ë¸ŒëŸ°ì¹˜ ë¹ˆ (ì¹´í˜ê±°ë¦¬) -->
        <div class="place-card" onclick="goToPlaceDetail('ë¸ŒëŸ°ì¹˜ ë¹ˆ')">
            <div class="place-img" style="background:#FBE9E7; color:#FF5722;">â˜•</div>
            <div class="place-info">
                <div class="place-name">ë¸ŒëŸ°ì¹˜ ë¹ˆ (ì¹´í˜ê±°ë¦¬)</div>
                <div class="place-time">ì˜¤ì „ 10~12ì‹œ ì—„ë§ˆë“¤ ëª¨ì„ ì¥ì†Œ</div>
            </div>
            <div class="btn-go">Go</div>
        </div>
    </div>

    <!-- 2-1. ì¥ì†Œ ìƒì„¸ í˜ì´ì§€ (í‘¸ë¥¸ì†” ê³µì›) -->
    <div id="page-place-detail" class="content-area page">
        <!-- ì¥ì†Œ ì´ë¦„ -->
        <h2 id="place-detail-title" style="font-size:18px; font-weight:700; color:var(--text-title); margin-bottom:12px;">íš¨ì›ê³µì›</h2>
        <!-- ì§€ë„ ì˜ì—­ (ì¥ì†Œ ì´ë¯¸ì§€ - Full-width) -->
        <div id="place-image-container" class="place-image-full">
            <!-- ê³µë€ í”Œë ˆì´ìŠ¤í™€ë” -->
            <div style="text-align:center;">
                <div style="font-size:48px; margin-bottom:8px; opacity:0.4;">ğŸ“</div>
                <div style="font-size:14px; color:var(--text-caption); opacity:0.6;">ì¥ì†Œ ì´ë¯¸ì§€ ì˜ì—­</div>
            </div>
        </div>

        <!-- ê±°ë¦¬/ì‹œê°„ ì •ë³´ ì¹´ë“œ -->
        <div class="place-info-grid" style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:24px;">
            <div style="background:white; border-radius:20px; padding:16px; box-shadow:var(--shadow-sm);">
                <div style="font-size:11px; color:var(--text-caption); margin-bottom:4px;">ë„ë³´ ê±°ë¦¬</div>
                <div style="font-size:18px; color:var(--primary); font-weight:700;">ì•½ 350m</div>
            </div>
            <div style="background:white; border-radius:20px; padding:16px; box-shadow:var(--shadow-sm);">
                <div style="font-size:11px; color:var(--text-caption); margin-bottom:4px;">ì†Œìš” ì‹œê°„</div>
                <div style="font-size:18px; color:var(--primary); font-weight:700;">ì•½ 5ë¶„</div>
            </div>
        </div>

        <!-- AI ê°€ì´ë“œ -->
        <div style="display:flex; align-items:center; gap:8px; margin-bottom:12px;">
            <div style="width:32px; height:32px; border-radius:50%; background:linear-gradient(135deg, var(--primary), #769F8B); display:flex; align-items:center; justify-content:center; font-size:16px;">
                ğŸ¤–
            </div>
            <span style="font-size:16px; color:var(--text-title); font-weight:600;">Think Mate ê°€ì´ë“œ</span>
        </div>

        <!-- ì²« ë²ˆì§¸ ë©”ì‹œì§€ -->
        <div class="ai-message" style="background:white; border-radius:20px 20px 20px 4px; padding:18px; margin-bottom:12px; box-shadow:var(--shadow-sm);">
            <p style="font-size:15px; color:var(--text-body); line-height:1.6;">
                ì, ì–´ì œ Aë‹¨ì§€ëŠ” ê°”ì—ˆì£ ?<br />
                ì˜¤ëŠ˜ì€ <strong style="color:var(--primary);">í‘¸ë¥¸ì†” ê³µì› ë†€ì´í„°</strong>ì…ë‹ˆë‹¤. ì—¬ê¸´ ì§€ê¸ˆ <strong style="color:#FF9800;">ì´ˆë“±ìƒ í•˜êµ ì‹œê°„</strong>ì´ë¼ ì—„ë§ˆë“¤ì´ ì œì¼ ë§ì´ ëª¨ì—¬ ìˆì–´ìš”!
            </p>
        </div>

        <!-- ì•Œëœ°ì¥í„° íŠ¹ë³„ ì•Œë¦¼ -->
        <div class="event-section" style="background:linear-gradient(135deg, #FFF8E1, #FFE082); border-radius:20px 20px 20px 4px; padding:20px; margin-bottom:16px; border:2px solid #FFC107; box-shadow:var(--shadow-md);">
            <p style="font-size:15px; color:#F57F17; line-height:1.6; margin-bottom:16px;">
                ê²Œë‹¤ê°€ ì˜¤ëŠ˜ ê±°ê¸´ <strong>ì•Œëœ°ì¥í„° ë‚ </strong>ì´ì—ìš”!<br />
                ì¥í„° íŒ€ì¥ë‹˜ ë²ˆí˜¸ ë„ì›Œë“œë¦´ í…Œë‹ˆ ìë¦¬ë¶€í„° ì¡ìœ¼ì„¸ìš”. íŒì´‰ë¬¼ ì±™ê¸°ì…¨ì£ ?
            </p>

            <!-- ì •ë³´ ì¹´ë“œ -->
            <div style="background:rgba(255,255,255,0.9); border-radius:16px; padding:16px;">
                <!-- ì´ë²¤íŠ¸ ì •ë³´ -->
                <div style="display:flex; align-items:start; gap:12px; padding-bottom:12px; border-bottom:1px solid #F0F0F0;">
                    <div style="font-size:20px;">ğŸš©</div>
                    <div style="flex:1;">
                        <div style="font-size:13px; color:var(--text-caption); margin-bottom:4px;">ì˜¤ëŠ˜ì˜ ì´ë²¤íŠ¸</div>
                        <div style="font-size:15px; color:var(--text-title);">C ì•„íŒŒíŠ¸ ì•Œëœ°ì¥í„° ì—´ë¦¼</div>
                    </div>
                </div>

                <!-- íŒ€ì¥ë‹˜ ì—°ë½ì²˜ -->
                <div style="display:flex; align-items:start; gap:12px; padding:12px 0; border-bottom:1px solid #F0F0F0;">
                    <div style="font-size:20px;">ğŸ“</div>
                    <div style="flex:1;">
                        <div style="font-size:13px; color:var(--text-caption); margin-bottom:4px;">ì¥í„° íŒ€ì¥ë‹˜</div>
                        <div style="font-size:15px; color:var(--primary); display:flex; align-items:center; gap:8px;">
                            010-3456-7890
                            <a href="tel:010-3456-7890" style="font-size:12px; background:var(--primary); color:white; padding:4px 12px; border-radius:20px; text-decoration:none;">ì „í™”</a>
                        </div>
                    </div>
                </div>

                <!-- ì¤€ë¹„ë¬¼ ì²´í¬ë¦¬ìŠ¤íŠ¸ -->
                <div style="display:flex; align-items:start; gap:12px; padding-top:12px;">
                    <div style="font-size:20px;">ğŸ’</div>
                    <div style="flex:1;">
                        <div style="font-size:13px; color:var(--text-caption); margin-bottom:8px;">ì¤€ë¹„ë¬¼ ì²´í¬ë¦¬ìŠ¤íŠ¸</div>
                        <div style="display:flex; flex-direction:column; gap:6px;">
                            <label style="display:flex; align-items:center; gap:8px; font-size:14px; color:var(--text-body); cursor:pointer;">
                                <input type="checkbox" style="width:16px; height:16px; accent-color:var(--primary); border-radius:4px;">
                                <span>í…Œì´ë¸” 1ê°œ</span>
                            </label>
                            <label style="display:flex; align-items:center; gap:8px; font-size:14px; color:var(--text-body); cursor:pointer;">
                                <input type="checkbox" style="width:16px; height:16px; accent-color:var(--primary); border-radius:4px;">
                                <span>íŒì´‰ë¬¼ 50ê°œ</span>
                            </label>
                            <label style="display:flex; align-items:center; gap:8px; font-size:14px; color:var(--text-body); cursor:pointer;">
                                <input type="checkbox" style="width:16px; height:16px; accent-color:var(--primary); border-radius:4px;">
                                <span>ëª…í•¨ & ë¦¬í”Œë ›</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì¶”ì²œ í™œë™ ì‹œê°„ -->
        <div class="tips-section" style="background:var(--primary-light); border-radius:16px; padding:16px; margin-bottom:24px;">
            <div style="display:flex; align-items:start; gap:12px;">
                <div style="font-size:20px;">ğŸ’¡</div>
                <div style="flex:1;">
                    <div style="font-size:13px; color:var(--primary); margin-bottom:8px; font-weight:600;">ì¶”ì²œ í™œë™ ì‹œê°„</div>
                    <div style="font-size:14px; color:var(--text-body); line-height:1.6;">
                        â€¢ ì˜¤í›„ 2ì‹œ~4ì‹œ: í•˜êµ ì‹œê°„ ì§‘ì¤‘ ê³µëµ<br />
                        â€¢ ì˜¤í›„ 4ì‹œ~6ì‹œ: ì•Œëœ°ì¥í„° ë°©ë¬¸ê° ëŒ€ìƒ
                    </div>
                </div>
            </div>
        </div>

        <!-- í•˜ë‹¨ ì•¡ì…˜ ë²„íŠ¼ -->
        <div style="display:flex; flex-direction:column; gap:10px; margin-top:24px; padding-bottom:20px;">
            <!-- ì¹´ì¹´ì˜¤ë‚´ë¹„ ë²„íŠ¼ -->
            <button id="btn-navi" onclick="goToNaviPage()" style="width:100%; height:56px; background:linear-gradient(135deg, var(--primary), #5D8A72); color:white; border:none; border-radius:16px; font-size:16px; font-weight:700; cursor:pointer; box-shadow:0 8px 20px rgba(74, 110, 93, 0.3); display:flex; align-items:center; justify-content:center; gap:8px; transition:all 0.2s;">
                <span>ğŸš€</span>
                <span>ì¹´ì¹´ì˜¤ë‚´ë¹„ë¡œ ì¶œë°œí•˜ê¸°</span>
            </button>
            <!-- í™œë™ GO! ë²„íŠ¼ -->
            <button class="btn-sales-start" onclick="startSalesActivity()" style="width:100%; height:56px; background:white; border:2px solid var(--primary); color:var(--primary); border-radius:16px; font-size:16px; font-weight:700; cursor:pointer; display:flex; align-items:center; justify-content:center; gap:8px; transition:all 0.2s;">
                <span>ğŸ’¼</span>
                <span>í™œë™ GO!</span>
            </button>
        </div>
    </div>

    <!-- 3. ì„±ê³¼ ì…ë ¥ ì±—ë´‡ í˜ì´ì§€ -->
    <div id="page-chat" class="page">
        <!-- LUMI í—¤ë” -->
        <div class="lumi-chat-header">
            <div class="lumi-avatar"></div>
            <div class="lumi-info">
                <div class="lumi-name">LUMI</div>
                <div class="lumi-status" id="chat-place-name">AI ì•¡ì…˜ ê°€ì´ë“œ</div>
            </div>
        </div>

        <!-- ì±„íŒ… ë©”ì‹œì§€ ì˜ì—­ -->
        <div class="chat-container" id="chat-box">
            <!-- ë™ì  ë©”ì‹œì§€ ì¶”ê°€ë¨ -->
        </div>

        <!-- ì„ íƒì§€ ì¹© (ì…ë ¥ë°” ìœ„ì— í‘œì‹œ) -->
        <div class="quick-chips" id="quick-replies">
            <!-- ì¹© ë²„íŠ¼ -->
        </div>

        <!-- í•˜ë‹¨ ê³ ì • ì…ë ¥ ë°” -->
        <div class="chat-input-bar">
            <input type="text" id="chat-input" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." />
            <button class="send-btn" id="chat-send-btn" onclick="sendChatMessage()"></button>
        </div>
    </div>

    <!-- 4. ë„¤ë¹„ê²Œì´ì…˜ í™”ë©´ (ì•± ì»¨í…Œì´ë„ˆ ë‚´ ì „ì²´ í™”ë©´) -->
    <div id="page-navi" class="page" style="position:absolute; top:0; left:0; right:0; bottom:0; background:#000; z-index:100; padding:0;">
        <!-- ë„¤ë¹„ ì´ë¯¸ì§€ ì•± ì»¨í…Œì´ë„ˆ ë‚´ ì „ì²´ -->
        <div style="width:100%; height:100%; position:relative; overflow:hidden;">
            <!-- ì‹¤ì œ ë„¤ë¹„ ì´ë¯¸ì§€ -->
            <img id="navi-image" src="íš¨ì›ê³µì›.jpg" alt="ë„¤ë¹„ê²Œì´ì…˜" style="width:100%; height:100%; object-fit:cover;">

            <!-- ë’¤ë¡œê°€ê¸° ë²„íŠ¼ (ì¢Œì¸¡ ìƒë‹¨) -->
            <div class="back-btn-common" onclick="goBackFromNavi()" style="position:absolute; top:20px; left:20px; z-index:10;"></div>
        </div>
    </div>

    <!-- 5. ë§ˆì´í˜ì´ì§€ -->
    <div id="page-mypage" class="content-area page">
        <!-- [NEW] ë§ˆì´í˜ì´ì§€ ì„±ê³¼ ì¹´ë“œ (í”„ë¡œí•„ í¬í•¨) -->
        <div class="performance-card">
            <!-- ë°°ê²½ ì¥ì‹ (ì½”ì¸ ì´ëª¨ì§€) -->
            <div class="deco-coin top-left">ğŸª™</div>
            <div class="deco-coin bottom-right">ğŸª™</div>

            <!-- [NEW] í”„ë¡œí•„ ì„¹ì…˜ì„ ì¹´ë“œ ë‚´ë¶€ ìµœìƒë‹¨ìœ¼ë¡œ ì´ë™ -->
            <div class="mypage-profile">
                <div class="mypage-avatar">ğŸ‘¨â€ğŸ’¼</div>
                <div class="mypage-user-info">
                    <h1>ê¹€ì”½í¬ ë‹˜</h1>
                    <p>ì˜¤ëŠ˜ë„ ì¢‹ì€ ì„±ê³¼ ê¸°ëŒ€í•´ìš”!</p>
                </div>
                <div class="perf-refresh-inline">â†»</div>
            </div>

            <div class="perf-list">
                <!-- 1. í˜„ì¬ ë³´ìœ  í¬ì¸íŠ¸ -->
                <div class="perf-item">
                    <span class="perf-label">í˜„ì¬ ë³´ìœ  í¬ì¸íŠ¸</span>
                    <div class="perf-value-wrap">
                        <span class="perf-value highlight">3,450 P</span>
                        <span class="perf-arrow">â€º</span>
                    </div>
                </div>
                <!-- 2. ì´ë²ˆ ì£¼ í™œë™ -->
                <div class="perf-item">
                    <span class="perf-label">ì´ë²ˆ ì£¼ í™œë™</span>
                    <div class="perf-value-wrap">
                        <span class="perf-value">12 íšŒ</span>
                        <span class="perf-arrow">â€º</span>
                    </div>
                </div>
                <!-- 3. íšë“ ë¦¬ë“œ -->
                <div class="perf-item">
                    <span class="perf-label">íšë“ ë¦¬ë“œ</span>
                    <div class="perf-value-wrap">
                        <span class="perf-value">8 ëª…</span>
                        <span class="perf-arrow">â€º</span>
                    </div>
                </div>
            </div>

            <!-- í¬ì¸íŠ¸ ì ë¦½ ê¸°ì¤€ -->
            <div class="perf-info">
                <div class="perf-info-title">ğŸ’¡ í¬ì¸íŠ¸ ì ë¦½ ê¸°ì¤€</div>
                <div class="perf-info-list">
                    <div class="perf-info-item">
                        <span>ì¶œì„ ì²´í¬</span>
                        <span>5 P</span>
                    </div>
                    <div class="perf-info-item">
                        <span>ì‹ ê·œ ì§„ë‹¨ / ì†ŒìŠ¤ í™•ë³´</span>
                        <span>ê° 20 P</span>
                    </div>
                    <div class="perf-info-item">
                        <span>ì…íšŒ ì„±ê³µ</span>
                        <span>50 P</span>
                    </div>
                    <div class="perf-info-item highlight">
                        <span>ì¼ì¼ ë¯¸ì…˜ ëª¨ë‘ ë‹¬ì„± ì‹œ</span>
                        <span>+100 P</span>
                    </div>
                </div>
            </div>

            <!-- í¬ì¸íŠ¸ ì‚¬ìš©ì²˜ ì•ˆë‚´ -->
            <div class="perf-usage-msg">
                ğŸ ëª¨ìœ¼ì‹  í¬ì¸íŠ¸ëŠ” <span class="underline">íŒì´‰ë¬¼</span>ì„ êµ¬ë§¤í•  ìˆ˜ ìˆì–´ìš”!
            </div>
        </div>

        <div class="section-title">ìµœê·¼ ë°©ë¬¸ ì´ë ¥</div>
        <div id="history-list">
            <!-- ìƒ˜í”Œ ë°ì´í„° 1: í‘¸ë¥¸ì†” ê³µì› -->
            <div class="place-card history-card" onclick="goToVisitResult(0)">
                <div class="place-img" style="background:#E8F5E9; color:#4CAF50;">ğŸŒ²</div>
                <div class="place-info">
                    <div class="place-name">í‘¸ë¥¸ì†” ê³µì›</div>
                    <div class="place-time" style="color:#999;">ì–´ì œ ë°©ë¬¸ Â· ë¦¬ë“œ 3ëª…</div>
                </div>
                <div class="arrow-icon">â€º</div>
            </div>
            <!-- ìƒ˜í”Œ ë°ì´í„° 2: ê¿ˆë‚˜ë¬´ ìœ ì¹˜ì› -->
            <div class="place-card history-card" onclick="goToVisitResult(1)">
                <div class="place-img" style="background:#FFF3E0; color:#FF9800;">ğŸ«</div>
                <div class="place-info">
                    <div class="place-name">ê¿ˆë‚˜ë¬´ ìœ ì¹˜ì›</div>
                    <div class="place-time" style="color:#999;">2ì¼ ì „ ë°©ë¬¸ Â· ë¦¬ë“œ 2ëª…</div>
                </div>
                <div class="arrow-icon">â€º</div>
            </div>
            <!-- ìƒ˜í”Œ ë°ì´í„° 3: ë§í¬ ê¸€ë¹› ë„ì„œê´€ -->
            <div class="place-card history-card" onclick="goToVisitResult(2)">
                <div class="place-img" style="background:#F3E5F5; color:#9C27B0;">ğŸ“š</div>
                <div class="place-info">
                    <div class="place-name">ë§í¬ ê¸€ë¹› ë„ì„œê´€</div>
                    <div class="place-time" style="color:#999;">3ì¼ ì „ ë°©ë¬¸ Â· ë¦¬ë“œ 1ëª…</div>
                </div>
                <div class="arrow-icon">â€º</div>
            </div>
        </div>
    </div>

    <!-- 6. ë°©ë¬¸ ê²°ê³¼ ìƒì„¸ í˜ì´ì§€ -->
    <div id="page-visit-result" class="content-area page">
        <!-- ê·¸ë¼ë””ì–¸íŠ¸ í—¤ë” -->
        <div class="visit-result-header">
            <div id="visit-result-icon" class="place-icon">ğŸŒ²</div>
            <div id="visit-result-title" class="place-title">í‘¸ë¥¸ì†” ê³µì›</div>
        </div>

        <!-- ë‚ ì§œ ë° ì‹œê°„ -->
        <div class="result-card">
            <div class="result-card-header">
                <div class="result-card-label">ğŸ“… ë‚ ì§œ ë° ì‹œê°„</div>
                <div class="result-card-edit" onclick="openModal('datetime')">ìˆ˜ì •</div>
            </div>
            <div id="visit-date" class="result-card-value">2024ë…„ 11ì›” 24ì¼</div>
            <div id="visit-time" class="result-card-value sub">14:00 ~ 16:30</div>
        </div>

        <!-- ë¦¬ë“œ -->
        <div class="result-card">
            <div class="result-card-header">
                <div class="result-card-label">ğŸ‘¥ ë¦¬ë“œ</div>
                <div class="result-card-edit" onclick="openModal('leads')">ìˆ˜ì •</div>
            </div>
            <div id="visit-leads" class="result-card-value" style="color:var(--secondary);">3ëª…</div>
        </div>

        <!-- ê²°ê³¼ -->
        <div class="result-card">
            <div class="result-card-header">
                <div class="result-card-label">âœ¨ ê²°ê³¼</div>
                <div class="result-card-edit" onclick="openModal('result')">ìˆ˜ì •</div>
            </div>
            <div id="visit-result-status" class="result-status source">ì†ŒìŠ¤ë§Œ í™•ë³´</div>
        </div>

        <!-- ë¹„ê³  -->
        <div class="result-card">
            <div class="result-card-header">
                <div class="result-card-label">ğŸ“ ë¹„ê³ </div>
                <div class="result-card-edit" onclick="openModal('note')">ìˆ˜ì •</div>
            </div>
            <div id="visit-note" class="result-card-value sub" style="white-space:pre-wrap;">ì•„ì´ ë‘ ëª… ì—„ë§ˆ, êµìœ¡ì— ê´€ì‹¬ ë§ìŒ.
ë‹¤ìŒì£¼ ìƒë‹´ ì˜ˆì •.</div>
        </div>
    </div>

    <!-- ëª¨ë‹¬ë“¤ -->
    <!-- ë‚ ì§œ/ì‹œê°„ ìˆ˜ì • ëª¨ë‹¬ -->
    <div id="modal-datetime" class="modal-overlay" onclick="closeModalOnOverlay(event, 'datetime')">
        <div class="modal-content">
            <div class="modal-title">ğŸ“… ë‚ ì§œ ë° ì‹œê°„ ìˆ˜ì •</div>
            <div class="modal-input-group">
                <label class="modal-input-label">ë‚ ì§œ</label>
                <input type="date" id="input-date" class="modal-input">
            </div>
            <div class="modal-input-group">
                <label class="modal-input-label">ì‹œì‘ ì‹œê°„</label>
                <input type="time" id="input-start-time" class="modal-input">
            </div>
            <div class="modal-input-group">
                <label class="modal-input-label">ì¢…ë£Œ ì‹œê°„</label>
                <input type="time" id="input-end-time" class="modal-input">
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeModal('datetime')">ì·¨ì†Œ</button>
                <button class="modal-btn save" onclick="saveDatetime()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- ë¦¬ë“œ ìˆ˜ì • ëª¨ë‹¬ -->
    <div id="modal-leads" class="modal-overlay" onclick="closeModalOnOverlay(event, 'leads')">
        <div class="modal-content">
            <div class="modal-title">ğŸ‘¥ ë¦¬ë“œ ìˆ˜ì •</div>
            <div class="modal-input-group">
                <label class="modal-input-label">ë¦¬ë“œ ìˆ˜ (ëª…)</label>
                <input type="number" id="input-leads" class="modal-input" min="0" placeholder="0">
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeModal('leads')">ì·¨ì†Œ</button>
                <button class="modal-btn save" onclick="saveLeads()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- ê²°ê³¼ ìˆ˜ì • ëª¨ë‹¬ -->
    <div id="modal-result" class="modal-overlay" onclick="closeModalOnOverlay(event, 'result')">
        <div class="modal-content">
            <div class="modal-title">âœ¨ ê²°ê³¼ ì„ íƒ</div>
            <div class="result-options">
                <div class="result-option" data-value="none" onclick="selectResultOption(this)">
                    <div class="result-option-icon" style="background:#F5F5F5;">â­•</div>
                    <div class="result-option-text">ì—†ìŒ</div>
                </div>
                <div class="result-option" data-value="source" onclick="selectResultOption(this)">
                    <div class="result-option-icon" style="background:#E3F2FD;">ğŸ“‹</div>
                    <div class="result-option-text">ì†ŒìŠ¤ë§Œ í™•ë³´</div>
                </div>
                <div class="result-option" data-value="success" onclick="selectResultOption(this)">
                    <div class="result-option-icon" style="background:#E8F5E9;">ğŸ‰</div>
                    <div class="result-option-text">ê³„ì•½ ì„±ê³µ</div>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeModal('result')">ì·¨ì†Œ</button>
                <button class="modal-btn save" onclick="saveResult()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- ë¹„ê³  ìˆ˜ì • ëª¨ë‹¬ -->
    <div id="modal-note" class="modal-overlay" onclick="closeModalOnOverlay(event, 'note')">
        <div class="modal-content">
            <div class="modal-title">ğŸ“ ë¹„ê³  ìˆ˜ì •</div>
            <div class="modal-input-group">
                <label class="modal-input-label">íŠ¹ì´ì‚¬í•­ ë©”ëª¨</label>
                <textarea id="input-note" class="modal-textarea" placeholder="ë°©ë¬¸ ì‹œ íŠ¹ì´ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeModal('note')">ì·¨ì†Œ</button>
                <button class="modal-btn save" onclick="saveNote()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- 6. ë­í‚¹ í˜ì´ì§€ -->
    <div id="page-ranking" class="content-area page">
        <!-- Top 3 í¬ë””ì›€ -->
        <div class="ranking-podium">
            <!-- 2ìœ„ -->
            <div class="podium-item podium-2">
                <div class="rank-avatar">ğŸ¥ˆ</div>
                <div class="rank-box">
                    <div class="rank-num">2</div>
                    <div class="rank-name">ë§ˆì›…ì§„</div>
                    <div class="rank-group">ë§ˆê³¡71ì§€ì—­êµ­</div>
                    <div class="rank-score">510pt</div>
                </div>
            </div>
            <!-- 1ìœ„ -->
            <div class="podium-item podium-1">
                <div class="rank-crown">ğŸ‘‘</div>
                <div class="rank-avatar">ğŸ¥‡</div>
                <div class="rank-box">
                    <div class="rank-num">1</div>
                    <div class="rank-name">ìˆ˜ì›…ì§„</div>
                    <div class="rank-group">ìˆ˜ì›11ì§€ì—­êµ­</div>
                    <div class="rank-score">520pt</div>
                </div>
            </div>
            <!-- 3ìœ„ -->
            <div class="podium-item podium-3">
                <div class="rank-avatar">ğŸ¥‰</div>
                <div class="rank-box">
                    <div class="rank-num">3</div>
                    <div class="rank-name">ê³ ì›…ì§„</div>
                    <div class="rank-group">ê³ ì–‘31ì§€ì—­êµ­</div>
                    <div class="rank-score">480pt</div>
                </div>
            </div>
        </div>

        <!-- 4~10ìœ„ ë¦¬ìŠ¤íŠ¸ -->
        <div class="ranking-list">
            <div class="rank-row">
                <div class="r-rank">4</div>
                <div class="r-info">
                    <span class="r-name">ì²œì›…ì§„</span>
                    <span class="r-group">ì²œì•ˆíƒ•ì •ì‚¬ì—…êµ­</span>
                </div>
                <div class="r-score">475pt</div>
            </div>
            <div class="rank-row">
                <div class="r-rank">5</div>
                <div class="r-info">
                    <span class="r-name">ì—¬ì›…ì§„</span>
                    <span class="r-group">ì—¬ìˆ˜ì‚¬ì—…êµ­</span>
                </div>
                <div class="r-score">460pt</div>
            </div>
            <div class="rank-row">
                <div class="r-rank">6</div>
                <div class="r-info">
                    <span class="r-name">í¬ì›…ì§„</span>
                    <span class="r-group">í¬í•­ì‚¬ì—…êµ­</span>
                </div>
                <div class="r-score">420pt</div>
            </div>
            <div class="rank-row">
                <div class="r-rank">7</div>
                <div class="r-info">
                    <span class="r-name">ë¶€ì›…ì§„</span>
                    <span class="r-group">ë¶€ì‚°ë™ë¶€ì§í• ì‚¬ì—…êµ­</span>
                </div>
                <div class="r-score">405pt</div>
            </div>
            <div class="rank-row">
                <div class="r-rank">8</div>
                <div class="r-info">
                    <span class="r-name">ì œì›…ì§„</span>
                    <span class="r-group">ì œì£¼ë‚¨ë¶€ì‚¬ì—…êµ­</span>
                </div>
                <div class="r-score">395pt</div>
            </div>
            <div class="rank-row">
                <div class="r-rank">9</div>
                <div class="r-info">
                    <span class="r-name">ìš©ì›…ì§„</span>
                    <span class="r-group">ìš©ì¸ì‚¬ì—…êµ­</span>
                </div>
                <div class="r-score">380pt</div>
            </div>
            <div class="rank-row">
                <div class="r-rank">10</div>
                <div class="r-info">
                    <span class="r-name">ìš©ì›…ì§„</span>
                    <span class="r-group">ìš©ì‚°ë§ˆí¬ì‚¬ì—…êµ­</span>
                </div>
                <div class="r-score">370pt</div>
            </div>
        </div>
    </div>

    <!-- [NEW] ì˜¤ëŠ˜ í™œë™ ì™„ë£Œ ë¦¬í¬íŠ¸ í˜ì´ì§€ -->
    <div id="page-finish">
        <!-- ë£¨ë¯¸ ì–¼êµ´ -->
        <div class="lumi-container" style="opacity:0; transform: translateY(20px);">
            <img src="LUMI_front_full.png" alt="Lumi" style="width:160px; height:160px; border-radius:50%; border:5px solid var(--primary); box-shadow: var(--shadow-float); object-fit: cover;">
        </div>

        <!-- ë¦¬í¬íŠ¸ í…ìŠ¤íŠ¸ -->
        <div class="report-text-container" style="text-align:center; margin-top:30px; width:100%;">

            <!-- 1. íƒ€ì´í‹€ -->
            <p class="report-line line-1" style="font-size:22px; font-weight:800; margin-bottom:16px; display:none; color:var(--text-title);">
                ì˜¤ëŠ˜ ë‹¬ì„±í•œ ì„±ê³¼ì•¼ âœ¨
            </p>

            <!-- 2. ì„±ê³¼ ë°•ìŠ¤ -->
            <div class="report-box line-2" style="background:#f5f7f6; padding:20px; border-radius:20px; margin:0 auto 24px auto; width:80%; display:none; box-shadow:var(--shadow-sm);">
                <p style="margin:6px 0; font-size:17px; font-weight:600; color:#2C3E50;">âœ… ì‹ ê·œ ì†ŒìŠ¤ 2ê°œ í™•ë³´</p>
                <p style="margin:6px 0; font-size:17px; font-weight:600; color:#2C3E50;">âœ… ì‹ ê·œ ì§„ë‹¨ 1ê°œ í™•ë³´</p>
            </div>

            <!-- 3. ì¹­ì°¬ -->
            <p class="report-line line-3" style="color:var(--primary); font-size:18px; font-weight:700; display:none; margin-bottom:30px;">
                ì–´ì œë³´ë‹¤ ë” ë§ì´ ë‹¬ì„±í–ˆëŠ”ë°? ğŸ˜²
            </p>

            <!-- 4. ë‚´ì¼ ì¶”ì²œ -->
            <p class="report-line line-4" style="font-size:16px; line-height:1.6; color:#555; display:none;">
                ë‚´ì¼ì€ <span style="background:#FFE0B2; padding:2px 8px; border-radius:8px; font-weight:bold; color:#E65100;">ë§¤íƒ„ì´ˆë“±í•™êµ</span> ì•ì„<br>ë°©ë¬¸í•´ ë³´ì.
            </p>

            <!-- 5. ë§ˆë¬´ë¦¬ -->
            <p class="report-line line-5" style="margin-top:40px; font-size:26px; font-weight:800; color:var(--text-title); display:none;">
                ì˜¤ëŠ˜ë„ ì •ë§ ê³ ìƒí–ˆì–´! ğŸ’–
            </p>
        </div>

        <!-- í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸° ë²„íŠ¼ -->
        <button class="btn-close-report" onclick="closeDailyReport()" style="margin-top:50px; display:none; background:var(--primary); color:white; border:none; padding:14px 40px; border-radius:30px; font-size:16px; font-weight:bold; box-shadow:0 4px 15px rgba(74, 110, 93, 0.3); cursor:pointer; transition:transform 0.2s;">
            í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸° ğŸ 
        </button>
    </div>

    <!-- í”Œë¡œíŒ… ì±—ë´‡ ë²„íŠ¼ (LUMI) -->
    <div class="floating-chat-btn" onclick="openChatBot()"></div>

</div>

<script>
    /* UI Interaction Scripts */

    // ëœë¤ í•«ìŠ¤íŒŸ ì„ íƒ
    function updateRandomHotspot() {
        const placeNames = ['íš¨ì›ê³µì›', 'íŒíƒ€ì§€ì›€', 'ì•„ì´íŒŒí¬ ìºìŠ¬', 'ë§í¬ ê¸€ë¹› ë„ì„œê´€', 'ë¸ŒëŸ°ì¹˜ ë¹ˆ'];
        const randomIndex = Math.floor(Math.random() * placeNames.length);
        const selectedPlace = placeNames[randomIndex];
        const detail = placeDetails[selectedPlace];

        if (detail) {
            // ì•„ì´ì½˜ ì—…ë°ì´íŠ¸
            const hotspotIcon = document.getElementById('hotspot-icon');
            if (hotspotIcon) {
                hotspotIcon.textContent = detail.icon;
            }

            // ì´ë¦„ ì—…ë°ì´íŠ¸
            const hotspotName = document.getElementById('hotspot-name');
            if (hotspotName) {
                hotspotName.textContent = detail.name;
            }

            // ì¹´ë“œ í´ë¦­ ì‹œ í•´ë‹¹ ì¥ì†Œ ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ë„ë¡ ì„¤ì •
            const hotspotCard = document.getElementById('hotspot-card');
            if (hotspotCard) {
                hotspotCard.onclick = () => goToPlaceDetail(selectedPlace);
            }
        }
    }

    // í˜ì´ì§€ íˆìŠ¤í† ë¦¬ ê´€ë¦¬
    let pageHistory = ['home'];

    // ë’¤ë¡œê°€ê¸° í•„ìš”í•œ ìƒì„¸ í˜ì´ì§€ë“¤
    const detailPages = ['place-detail', 'visit-result', 'recommend', 'chat'];

    // í˜ì´ì§€ ì´ë™
    function goToPage(pageId) {
        // í˜ì´ì§€ ì „í™˜
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById('page-' + pageId).classList.add('active');

        // ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ í™œì„±í™” ìƒíƒœ ë³€ê²½
        document.querySelectorAll('.nav-text-item').forEach(item => {
            item.classList.remove('active');
            item.style.color = 'var(--text-caption)';
        });

        // í´ë¦­í•œ ë©”ë‰´ í™œì„±í™”
        const navMap = {'home':0, 'mypage':1, 'ranking':2, 'recommend':0, 'chat':0};
        const navItems = document.querySelectorAll('.nav-text-item');
        if(navItems[navMap[pageId]] !== undefined) {
            navItems[navMap[pageId]].classList.add('active');
            navItems[navMap[pageId]].style.color = 'var(--primary)';
        }

        // ë’¤ë¡œê°€ê¸° ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€
        const backBtn = document.getElementById('header-back-btn');
        if (detailPages.includes(pageId)) {
            backBtn.style.visibility = 'visible';
        } else {
            backBtn.style.visibility = 'hidden';
        }

        // íˆìŠ¤í† ë¦¬ ê´€ë¦¬ (ë©”ì¸ í˜ì´ì§€ë©´ íˆìŠ¤í† ë¦¬ ì´ˆê¸°í™”)
        if (['home', 'mypage', 'ranking'].includes(pageId)) {
            pageHistory = [pageId];
        } else {
            pageHistory.push(pageId);
        }

        // í”Œë¡œíŒ… LUMI ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€ (ì±„íŒ… í˜ì´ì§€ì—ì„œëŠ” ìˆ¨ê¹€)
        const floatingBtn = document.querySelector('.floating-chat-btn');
        if (floatingBtn) {
            floatingBtn.style.display = (pageId === 'chat') ? 'none' : 'flex';
        }

        // ì±„íŒ… í˜ì´ì§€ ì´ˆê¸°í™” (í™œë™ GOì—ì„œ ì§„ì… ì‹œ ìŠ¤í‚µ)
        if(pageId === 'chat' && !window.skipInitChat) {
            initChat();
        }
        window.skipInitChat = false; // í”Œë˜ê·¸ ì´ˆê¸°í™”
    }

    // ë’¤ë¡œê°€ê¸°
    function goBack() {
        if (pageHistory.length > 1) {
            pageHistory.pop(); // í˜„ì¬ í˜ì´ì§€ ì œê±°
            const prevPage = pageHistory[pageHistory.length - 1];
            goToPage(prevPage);
        } else {
            goToPage('home');
        }
    }

    // ì¥ì†Œë³„ ìƒì„¸ ì •ë³´ ë°ì´í„°
    const placeDetails = {
        'íš¨ì›ê³µì›': {
            icon: 'ğŸŒ²',
            name: 'íš¨ì›ê³µì›',
            naviImage: 'íš¨ì›ê³µì›.jpg',
            mapImage: 'íš¨ì›ê³µì›_map.jpg',
            distance: '350m',
            time: '5ë¶„',
            message1: 'ì, ì–´ì œ Aë‹¨ì§€ëŠ” ê°”ì—ˆì£ ?<br />ì˜¤ëŠ˜ì€ <strong style="color:var(--primary);">íš¨ì›ê³µì›</strong>ì…ë‹ˆë‹¤. ì—¬ê¸´ ì§€ê¸ˆ <strong style="color:#FF9800;">ì´ˆë“±ìƒ í•˜êµ ì‹œê°„</strong>ì´ë¼ ì—„ë§ˆë“¤ì´ ì œì¼ ë§ì´ ëª¨ì—¬ ìˆì–´ìš”!',
            hasEvent: true,
            eventTitle: 'ì•Œëœ°ì¥í„° ë‚ ',
            eventInfo: {
                event: 'C ì•„íŒŒíŠ¸ ì•Œëœ°ì¥í„° ì—´ë¦¼',
                contact: '010-3456-7890',
                checklist: ['í…Œì´ë¸” 1ê°œ', 'íŒì´‰ë¬¼ 50ê°œ', 'ëª…í•¨ & ë¦¬í”Œë ›']
            },
            tips: 'â€¢ ì˜¤í›„ 2ì‹œ~4ì‹œ: í•˜êµ ì‹œê°„ ì§‘ì¤‘ ê³µëµ<br />â€¢ ì˜¤í›„ 4ì‹œ~6ì‹œ: ì•Œëœ°ì¥í„° ë°©ë¬¸ê° ëŒ€ìƒ'
        },
        'íŒíƒ€ì§€ì›€': {
            icon: 'ğŸ°',
            name: 'íŒíƒ€ì§€ì›€',
            naviImage: 'ë”íŒíƒ€ì§€ì›€.jpg',
            mapImage: 'ë”íŒíƒ€ì§€ì›€_map.jpg',
            distance: '420m',
            time: '6ë¶„',
            message1: 'íŒíƒ€ì§€ì›€ì€ <strong style="color:var(--primary);">í‚¤ì¦ˆì¹´í˜, ë³‘ì›, ì‡¼í•‘ëª°</strong>ì´ ëª¨ë‘ ëª¨ì—¬ìˆëŠ” ì˜í†µ ë§˜ë“¤ì˜ í•«í”Œë ˆì´ìŠ¤ì˜ˆìš”!<br />ì†Œë¹„ë ¥ì´ ë†’ì€ ê³ ê°ë“¤ì„ ë§Œë‚  ìˆ˜ ìˆëŠ” ìµœì ì˜ ì¥ì†Œì…ë‹ˆë‹¤.',
            hasEvent: false,
            specialInfo: {
                title: 'ì£¼ìš” íƒ€ê²Ÿ',
                items: [
                    'ğŸ‘¨\u200dğŸ‘©\u200dğŸ‘§\u200dğŸ‘¦ 3~7ì„¸ ìë…€ë¥¼ ë‘” ê°€ì¡±',
                    'ğŸ’° ì›” ì†Œë“ ìƒìœ„ 30% ì´ìƒ',
                    'ğŸ¥ ì†Œì•„ê³¼ ëŒ€ê¸° ì¤‘ì¸ ë¶€ëª¨ë‹˜'
                ]
            },
            tips: 'â€¢ ì˜¤ì „ 10ì‹œ~12ì‹œ: í‚¤ì¦ˆì¹´í˜ ì´ìš© ê°€ì¡±<br />â€¢ ì˜¤í›„ 2ì‹œ~5ì‹œ: ì†Œì•„ê³¼ ëŒ€ê¸°ì‹¤ ê³µëµ'
        },
        'ì•„ì´íŒŒí¬ ìºìŠ¬': {
            icon: 'ğŸšŒ',
            name: 'ì•„ì´íŒŒí¬ ìºìŠ¬ 1ë‹¨ì§€',
            naviImage: 'ì•„ì´íŒŒí¬ìºìŠ¬.jpg',
            mapImage: 'ì•„ì´íŒŒí¬ìºìŠ¬_map.jpg',
            distance: '280m',
            time: '4ë¶„',
            message1: 'ì•„ì´íŒŒí¬ ìºìŠ¬ì€ <strong style="color:var(--primary);">ìœ ì¹˜ì›Â·í•™ì› ì…”í‹€ë²„ìŠ¤</strong>ê°€ ì§‘ê²°í•˜ëŠ” ê³³ì´ì—ìš”!<br />ê·¼ì²˜ì— <strong style="color:#FF9800;">ê¿ˆë‚˜ë¬´ ìœ ì¹˜ì›, í•´ë‹˜ ì–´ë¦°ì´ì§‘</strong>ì´ ìˆì–´ì„œ ì–´ë¨¸ë‹ˆë“¤ì´ ì•„ì´ë“¤ì˜ í•˜ì›ì„ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš”.',
            hasEvent: false,
            specialInfo: {
                title: 'í•˜ì› ì‹œê°„í‘œ',
                items: [
                    'ğŸšŒ ê¿ˆë‚˜ë¬´ ìœ ì¹˜ì›: 14:00, 16:00',
                    'ğŸšŒ í•´ë‹˜ ì–´ë¦°ì´ì§‘: 14:30, 15:30',
                    'ğŸ“š ì˜ì–´í•™ì›: 15:00, 17:00'
                ]
            },
            tips: 'â€¢ ì˜¤í›„ 1ì‹œ 30ë¶„~2ì‹œ: ì²« í•˜ì› ëŒ€ê¸°<br />â€¢ ì˜¤í›„ 3ì‹œ~4ì‹œ: í”¼í¬ íƒ€ì„ ì§‘ì¤‘ ê³µëµ'
        },
        'ë§í¬ ê¸€ë¹› ë„ì„œê´€': {
            icon: 'ğŸ“š',
            name: 'ë§í¬ ê¸€ë¹› ë„ì„œê´€',
            naviImage: 'ë§í¬ê¸€ë¹›ë„ì„œê´€.jpg',
            mapImage: 'ë§í¬ê¸€ë¹›ë„ì„œê´€_map.jpg',
            distance: '520m',
            time: '7ë¶„',
            message1: 'ë§í¬ ê¸€ë¹› ë„ì„œê´€ì€ <strong style="color:var(--primary);">êµìœ¡ì—´ì´ ë†’ì€ ë¶€ëª¨ë‹˜ë“¤</strong>ì´ ì•„ì´ë“¤ê³¼ í•¨ê»˜ ë°©ë¬¸í•˜ëŠ” ê³³ì´ì—ìš”!<br /><strong style="color:#FF9800;">í•™ìŠµ ê´€ë ¨ ëŒ€í™”</strong>ê°€ ìì—°ìŠ¤ëŸ½ê²Œ í†µí•˜ëŠ” íƒ€ê²Ÿì¸µì…ë‹ˆë‹¤.',
            hasEvent: false,
            specialInfo: {
                title: 'ì ‘ê·¼ í¬ì¸íŠ¸',
                items: [
                    'ğŸ“– 1ì¸µ ì–´ë¦°ì´ ì—´ëŒì‹¤ ì•',
                    'â˜• ì¹´í˜í…Œë¦¬ì•„ (í•™ë¶€ëª¨ íœ´ê²Œ ê³µê°„)',
                    'ğŸ¨ ë¬¸í™” ê°•ì¢Œì‹¤ (ì˜ì–´/ë¯¸ìˆ  ìˆ˜ì—…)'
                ]
            },
            tips: 'â€¢ ì˜¤ì „ 10ì‹œ~12ì‹œ: ì˜ìœ ì•„ í”„ë¡œê·¸ë¨ ì°¸ì—¬ ê°€ì¡±<br />â€¢ ì˜¤í›„ 3ì‹œ~6ì‹œ: ì´ˆë“±ìƒ ìê¸°ì£¼ë„í•™ìŠµ í•™ë¶€ëª¨'
        },
        'ë¸ŒëŸ°ì¹˜ ë¹ˆ': {
            icon: 'â˜•',
            name: 'ë¸ŒëŸ°ì¹˜ ë¹ˆ (ì¹´í˜ê±°ë¦¬)',
            naviImage: 'ë¸ŒëŸ°ì¹˜ë¹ˆ.jpg',
            mapImage: 'ë¸ŒëŸ°ì¹˜ë¹ˆ_map.jpg',
            distance: '380m',
            time: '5ë¶„',
            message1: 'ë¸ŒëŸ°ì¹˜ ë¹ˆì€ <strong style="color:var(--primary);">ì˜¤ì „ 10~12ì‹œ</strong> ì‚¬ì´ ì—„ë§ˆë“¤ì˜ ëª¨ì„ ì¥ì†Œë¡œ ìœ ëª…í•´ìš”!<br />ê·¼ì²˜ì— <strong style="color:#FF9800;">ìš”ê°€í•™ì›, í•„ë¼í…ŒìŠ¤</strong>ê°€ ìˆì–´ì„œ ìš´ë™ í›„ ì°¨ í•œì” í•˜ëŸ¬ ì˜¤ì‹œëŠ” ë¶„ë“¤ì´ ë§ì•„ìš”.',
            hasEvent: false,
            specialInfo: {
                title: 'ì ‘ê·¼ ì „ëµ',
                items: [
                    'â˜• í…Œë¼ìŠ¤ ì¢Œì„ (ì•¼ì™¸ì—ì„œ ì ‘ê·¼)',
                    'ğŸ¥ ë¸ŒëŸ°ì¹˜ íƒ€ì„ (10:30~12:00)',
                    'ğŸ§˜\u200dâ™€ï¸ ìš”ê°€/í•„ë¼í…ŒìŠ¤ ìˆ˜ì—… ì¢…ë£Œ ì‹œê°„ ì²´í¬'
                ]
            },
            tips: 'â€¢ ì˜¤ì „ 10ì‹œ~11ì‹œ: ìš´ë™ ë§ˆì¹œ ì—„ë§ˆë“¤<br />â€¢ ì˜¤ì „ 11ì‹œ~12ì‹œ: ë¸ŒëŸ°ì¹˜ ëª¨ì„ í”¼í¬íƒ€ì„'
        }
    };

    // í˜„ì¬ ì„ íƒëœ ì¥ì†Œë¥¼ ì „ì—­ ë³€ìˆ˜ë¡œ ì €ì¥
    window.currentPlace = null;
    window.previousPage = 'recommend'; // ë„¤ë¹„ í™”ë©´ì—ì„œ ëŒì•„ê°ˆ í˜ì´ì§€ ì €ì¥

    // ì¥ì†Œ ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™
    function goToPlaceDetail(placeName) {
        const detail = placeDetails[placeName];
        if (!detail) return;

        // í˜„ì¬ ì¥ì†Œ ì €ì¥
        window.currentPlace = placeName;

        // í˜ì´ì§€ ë‚´ìš© ì—…ë°ì´íŠ¸
        const detailPage = document.getElementById('page-place-detail');

        // ì œëª© ì—…ë°ì´íŠ¸
        document.getElementById('place-detail-title').textContent = detail.name;

        // ì§€ë„ ì´ë¯¸ì§€ + í•€ ë§ˆì»¤ ì—…ë°ì´íŠ¸
        const imageContainer = document.getElementById('place-image-container');
        if (detail.mapImage) {
            imageContainer.innerHTML = `
                <img src="${detail.mapImage}" alt="${detail.name} ì§€ë„" style="width:100%; height:100%; object-fit:cover;">
                <div class="map-pin">ğŸ“</div>`;
        } else {
            imageContainer.innerHTML = `
                <div style="text-align:center;">
                    <div style="font-size:48px; margin-bottom:8px; opacity:0.4;">ğŸ“</div>
                    <div style="font-size:14px; color:var(--text-caption); opacity:0.6;">ì¥ì†Œ ì´ë¯¸ì§€ ì˜ì—­</div>
                </div>`;
        }

        // ê±°ë¦¬/ì‹œê°„ ì—…ë°ì´íŠ¸
        const distanceCards = detailPage.querySelectorAll('.place-info-grid > div');
        distanceCards[0].querySelector('div:last-child').textContent = `ì•½ ${detail.distance}`;
        distanceCards[1].querySelector('div:last-child').textContent = `ì•½ ${detail.time}`;

        // AI ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
        detailPage.querySelector('.ai-message').innerHTML = `<p style="font-size:15px; color:var(--text-body); line-height:1.6;">${detail.message1}</p>`;

        // ì´ë²¤íŠ¸/íŠ¹ë³„ ì •ë³´ ì„¹ì…˜ ì—…ë°ì´íŠ¸
        const eventSection = detailPage.querySelector('.event-section');
        if (detail.hasEvent) {
            eventSection.style.display = 'block';
            eventSection.innerHTML = `
                <p style="font-size:15px; color:#F57F17; line-height:1.6; margin-bottom:16px;">
                    ê²Œë‹¤ê°€ ì˜¤ëŠ˜ ê±°ê¸´ <strong>${detail.eventTitle}</strong>ì´ì—ìš”!<br />
                    ì¥í„° íŒ€ì¥ë‹˜ ë²ˆí˜¸ ë„ì›Œë“œë¦´ í…Œë‹ˆ ìë¦¬ë¶€í„° ì¡ìœ¼ì„¸ìš”. íŒì´‰ë¬¼ ì±™ê¸°ì…¨ì£ ?
                </p>
                <div style="background:rgba(255,255,255,0.9); border-radius:16px; padding:16px;">
                    <div style="display:flex; align-items:start; gap:12px; padding-bottom:12px; border-bottom:1px solid #F0F0F0;">
                        <div style="font-size:20px;">ğŸš©</div>
                        <div style="flex:1;">
                            <div style="font-size:13px; color:var(--text-caption); margin-bottom:4px;">ì˜¤ëŠ˜ì˜ ì´ë²¤íŠ¸</div>
                            <div style="font-size:15px; color:var(--text-title);">${detail.eventInfo.event}</div>
                        </div>
                    </div>
                    <div style="display:flex; align-items:start; gap:12px; padding:12px 0; border-bottom:1px solid #F0F0F0;">
                        <div style="font-size:20px;">ğŸ“</div>
                        <div style="flex:1;">
                            <div style="font-size:13px; color:var(--text-caption); margin-bottom:4px;">ì¥í„° íŒ€ì¥ë‹˜</div>
                            <div style="font-size:15px; color:var(--primary); display:flex; align-items:center; gap:8px;">
                                ${detail.eventInfo.contact}
                                <a href="tel:${detail.eventInfo.contact}" style="font-size:12px; background:var(--primary); color:white; padding:4px 12px; border-radius:20px; text-decoration:none;">ì „í™”</a>
                            </div>
                        </div>
                    </div>
                    <div style="display:flex; align-items:start; gap:12px; padding-top:12px;">
                        <div style="font-size:20px;">ğŸ’</div>
                        <div style="flex:1;">
                            <div style="font-size:13px; color:var(--text-caption); margin-bottom:8px;">ì¤€ë¹„ë¬¼ ì²´í¬ë¦¬ìŠ¤íŠ¸</div>
                            <div style="display:flex; flex-direction:column; gap:6px;">
                                ${detail.eventInfo.checklist.map(item => `
                                    <label style="display:flex; align-items:center; gap:8px; font-size:14px; color:var(--text-body); cursor:pointer;">
                                        <input type="checkbox" style="width:16px; height:16px; accent-color:var(--primary); border-radius:4px;">
                                        <span>${item}</span>
                                    </label>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        } else if (detail.specialInfo) {
            eventSection.style.display = 'block';
            eventSection.innerHTML = `
                <div style="background:rgba(255,255,255,0.9); border-radius:16px; padding:20px; box-shadow:var(--shadow-sm);">
                    <div style="display:flex; align-items:start; gap:12px;">
                        <div style="font-size:24px;">${detail.icon}</div>
                        <div style="flex:1;">
                            <div style="font-size:15px; color:var(--primary); margin-bottom:12px; font-weight:700;">${detail.specialInfo.title}</div>
                            <div style="display:flex; flex-direction:column; gap:8px;">
                                ${detail.specialInfo.items.map(item => `
                                    <div style="font-size:14px; color:var(--text-body); line-height:1.5;">
                                        ${item}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // íŒ ì„¹ì…˜ ì—…ë°ì´íŠ¸
        detailPage.querySelector('.tips-section').innerHTML = `
            <div style="display:flex; align-items:start; gap:12px;">
                <div style="font-size:20px;">ğŸ’¡</div>
                <div style="flex:1;">
                    <div style="font-size:13px; color:var(--primary); margin-bottom:8px; font-weight:600;">ì¶”ì²œ í™œë™ ì‹œê°„</div>
                    <div style="font-size:14px; color:var(--text-body); line-height:1.6;">
                        ${detail.tips}
                    </div>
                </div>
            </div>
        `;

        // í˜ì´ì§€ ì „í™˜
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        detailPage.classList.add('active');

        // ë’¤ë¡œê°€ê¸° ë²„íŠ¼ í‘œì‹œ
        document.getElementById('header-back-btn').style.visibility = 'visible';

        // íˆìŠ¤í† ë¦¬ì— ì¶”ê°€
        pageHistory.push('place-detail');

        // ì´ì „ í˜ì´ì§€ ì €ì¥
        window.previousPage = 'place-detail';
    }

    // ë„¤ë¹„ í˜ì´ì§€ë¡œ ì´ë™
    function goToNaviPage() {
        if (!window.currentPlace) return;

        const detail = placeDetails[window.currentPlace];
        if (!detail || !detail.naviImage) return;

        // ë„¤ë¹„ ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸
        const naviPage = document.getElementById('page-navi');
        const naviImage = naviPage.querySelector('#navi-image');
        if (naviImage) {
            naviImage.src = detail.naviImage;
            naviImage.alt = `${detail.name} ë„¤ë¹„ê²Œì´ì…˜`;
        }

        // í˜ì´ì§€ ì „í™˜
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        naviPage.classList.add('active');
    }

    // ë„¤ë¹„ í™”ë©´ì—ì„œ ë’¤ë¡œê°€ê¸°
    function goBackFromNavi() {
        goToPage(window.previousPage || 'place-detail');
    }

    // ì¥ì†Œ ë°ì´í„° (ì•„ì´ì½˜ í¬í•¨)
    const placeOptionsData = [
        { name: 'í‘¸ë¥¸ì†” ê³µì› ë†€ì´í„°', icon: 'ğŸŒ²', iconBg: '#E8F5E9', iconColor: '#4CAF50' },
        { name: 'ê¿ˆë‚˜ë¬´ ìœ ì¹˜ì›', icon: 'ğŸ«', iconBg: '#FFF3E0', iconColor: '#FF9800' },
        { name: 'ë§í¬ ê¸€ë¹› ë„ì„œê´€', icon: 'ğŸ“š', iconBg: '#F3E5F5', iconColor: '#9C27B0' },
        { name: 'ê¸°íƒ€ ì¥ì†Œ', icon: 'ğŸ¢', iconBg: '#E0E0E0', iconColor: '#757575' }
    ];

    // ì±—ë´‡ ê¸°ëŠ¥ - ë©”ì¸ ì§„ì…ì  (ìƒˆë¡œìš´ ì‹œë‚˜ë¦¬ì˜¤)
    function initChat() {
        const chatBox = document.getElementById('chat-box');
        chatBox.innerHTML = ''; // ì´ˆê¸°í™”
        document.getElementById('quick-replies').innerHTML = '';
        chatInputMode = 'idle'; // ì…ë ¥ ëª¨ë“œ ì´ˆê¸°í™”
        qnaCount = 0;

        // ì´ˆê¸° ë©”ë‰´ í‘œì‹œ
        setTimeout(() => {
            addBotMsg("ì•ˆë…•í•˜ì„¸ìš”! <strong>LUMI</strong>ì…ë‹ˆë‹¤. ğŸ§šâ€â™€ï¸<br>ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”?");

            setTimeout(() => {
                const options = ['ì„±ê³¼ ë“±ë¡', 'í™œë™ ì¶”ì²œ', 'ì§ˆì˜ì‘ë‹µ'];
                setChips(options, (val) => {
                    addUserMsg(val);
                    if (val === 'ì„±ê³¼ ë“±ë¡') {
                        startSalesChatFlow();
                    } else if (val === 'í™œë™ ì¶”ì²œ') {
                        setTimeout(() => {
                            addBotMsg("ë„¤, ê·¸ëŸ¼ ì œê°€ í˜„ì¬ ìœ„ì¹˜ì™€ ì‹œê°„ì„ ê³ ë ¤í•˜ì—¬ ì¶”ì²œí•´ë“œë¦´ê²Œìš”!");
                            setTimeout(() => {
                                goToPage('recommend');
                            }, 1500);
                        }, 500);
                    } else if (val === 'ì§ˆì˜ì‘ë‹µ') {
                        startQnAFlow();
                    }
                });
            }, 600);
        }, 400);
    }

    // --- ì„±ê³¼ ë“±ë¡ ì‹œë‚˜ë¦¬ì˜¤ (ìƒˆë¡œìš´ ìˆœì„œ: ë¦¬ë“œ â†’ ì¥ì†Œ â†’ ì„±ê³¼ â†’ íŠ¹ì´ì‚¬í•­) ---
    function startSalesChatFlow() {
        // ì„ì‹œ ë°ì´í„° ì´ˆê¸°í™”
        window.tempSalesData = {
            placeName: '',
            icon: 'ğŸ“',
            iconBg: '#E0E0E0',
            iconColor: '#757575',
            leads: 0,
            result: 'none',
            note: ''
        };

        // Q1. ë¦¬ë“œ ìˆ˜ ì§ˆë¬¸
        setTimeout(() => {
            addBotMsg("ì˜¤ëŠ˜ ë§Œë‚œ <strong>ë¦¬ë“œ(ê°€ë§ê³ ê°)</strong>ëŠ” ëª‡ ë¶„ì´ì‹ ê°€ìš”?");
            const leadOptions = ['0ëª…', '1ëª…', '2ëª…', '3ëª…', '4ëª…', '5ëª…', '6ëª… ì´ìƒ'];
            setChips(leadOptions, (val) => {
                addUserMsg(val);
                if (val === '6ëª… ì´ìƒ') window.tempSalesData.leads = 6;
                else window.tempSalesData.leads = parseInt(val);

                // Q2. ì¥ì†Œ ì„ íƒ
                setTimeout(() => askPlace(), 600);
            });
        }, 600);
    }

    // Q2. ì¥ì†Œ ì„ íƒ
    function askPlace() {
        addBotMsg("ì–´ëŠ ì¥ì†Œì—ì„œ í™œë™í•˜ì…¨ë‚˜ìš”?");

        const chipBox = document.getElementById('quick-replies');
        chipBox.innerHTML = '';

        // ê¸°ì¡´ ì¥ì†Œ + ê¸°íƒ€ ì¥ì†Œ ì˜µì…˜
        const allPlaces = [...placeOptionsData, { icon: 'ğŸ¢', name: 'ê¸°íƒ€ ì¥ì†Œ', iconBg: '#E0E0E0', iconColor: '#757575' }];

        allPlaces.forEach(place => {
            const btn = document.createElement('div');
            btn.className = 'chip';
            btn.innerHTML = `${place.icon} ${place.name}`;
            btn.onclick = () => {
                if (place.name === 'ê¸°íƒ€ ì¥ì†Œ') {
                    addUserMsg(`${place.icon} ${place.name}`);
                    askManualPlaceInput();
                } else {
                    addUserMsg(`${place.icon} ${place.name}`);
                    window.tempSalesData.placeName = place.name;
                    window.tempSalesData.icon = place.icon;
                    window.tempSalesData.iconBg = place.iconBg;
                    window.tempSalesData.iconColor = place.iconColor;
                    chipBox.innerHTML = '';
                    setTimeout(() => askResult(), 600);
                }
            };
            chipBox.appendChild(btn);
        });
    }

    // ê¸°íƒ€ ì¥ì†Œ ì…ë ¥
    function askManualPlaceInput() {
        addBotMsg("ì¥ì†Œ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
        const chipBox = document.getElementById('quick-replies');
        chipBox.innerHTML = '';

        const inputWrapper = document.createElement('div');
        inputWrapper.style.cssText = 'display:flex; gap:8px; width:100%; margin-top:8px;';

        const textInput = document.createElement('input');
        textInput.type = 'text';
        textInput.placeholder = 'ì¥ì†Œ ì´ë¦„ ì…ë ¥...';
        textInput.style.cssText = 'flex:1; padding:12px 16px; border:2px solid #E0E0E0; border-radius:14px; font-size:14px; font-family:inherit;';

        const submitBtn = document.createElement('button');
        submitBtn.innerText = 'í™•ì¸';
        submitBtn.style.cssText = 'padding:12px 20px; background:var(--primary); color:white; border:none; border-radius:14px; font-size:14px; font-weight:600; cursor:pointer;';

        submitBtn.onclick = () => {
            const name = textInput.value.trim();
            if(name) {
                addUserMsg(name);
                window.tempSalesData.placeName = name;
                window.tempSalesData.icon = 'ğŸ¢';
                window.tempSalesData.iconBg = '#E0E0E0';
                window.tempSalesData.iconColor = '#757575';

                setTimeout(() => askResult(), 600);
            }
        };

        textInput.onkeypress = (e) => { if(e.key === 'Enter') submitBtn.click(); };

        inputWrapper.appendChild(textInput);
        inputWrapper.appendChild(submitBtn);
        chipBox.appendChild(inputWrapper);
        setTimeout(() => textInput.focus(), 100);
    }

    // Q3. ê³„ì•½ ì„±ê³¼ ì§ˆë¬¸
    function askResult() {
        addBotMsg("ê³ ìƒí•˜ì…¨ìŠµë‹ˆë‹¤! í˜¹ì‹œ <strong>ê³„ì•½ ì„±ê³¼</strong>ë„ ìˆì—ˆë‚˜ìš”?");
        const resultOptions = ['ì—†ìŒ', 'ì†ŒìŠ¤ë§Œ í™•ë³´', 'ê³„ì•½ ì„±ê³µ!'];
        setChips(resultOptions, (val) => {
            addUserMsg(val);
            if(val === 'ì—†ìŒ') window.tempSalesData.result = 'none';
            else if(val === 'ì†ŒìŠ¤ë§Œ í™•ë³´') window.tempSalesData.result = 'source';
            else window.tempSalesData.result = 'success';

            setTimeout(() => askNote(), 600);
        });
    }

    // Q4. íŠ¹ì´ì‚¬í•­ ì§ˆë¬¸
    function askNote() {
        addBotMsg("ê·¸ëŸ¼ ê¸°íƒ€ íŠ¹ì´ì‚¬í•­ì€ ìˆì—ˆë‚˜ìš”? ğŸ“<br><span style='font-size:13px; color:var(--text-caption);'>(ì˜ˆ: íŒì´‰ë¬¼ í•„ìš” ì—¬ë¶€, ê´€ë ¨ ë‹´ë‹¹ì ì‘ëŒ€ ë°©ë²•)</span>");

        const chipBox = document.getElementById('quick-replies');
        chipBox.innerHTML = '';

        const inputWrapper = document.createElement('div');
        inputWrapper.style.cssText = 'display:flex; gap:8px; width:100%; margin-top:8px;';

        const textInput = document.createElement('input');
        textInput.type = 'text';
        textInput.placeholder = 'íŠ¹ì´ì‚¬í•­ ì…ë ¥...';
        textInput.style.cssText = 'flex:1; padding:12px 16px; border:2px solid #E0E0E0; border-radius:14px; font-size:14px; font-family:inherit;';

        const submitBtn = document.createElement('button');
        submitBtn.innerText = 'ì™„ë£Œ';
        submitBtn.style.cssText = 'padding:12px 20px; background:var(--primary); color:white; border:none; border-radius:14px; font-size:14px; font-weight:600; cursor:pointer;';

        const complete = (text) => {
            window.tempSalesData.note = text;
            addUserMsg(text || 'ì—†ìŒ');
            chipBox.innerHTML = '';

            // ë°ì´í„° ì €ì¥
            const now = new Date();
            const newVisit = {
                id: visitHistoryData.length,
                name: window.tempSalesData.placeName,
                icon: window.tempSalesData.icon,
                iconBg: window.tempSalesData.iconBg,
                iconColor: window.tempSalesData.iconColor,
                date: now.toISOString().split('T')[0],
                startTime: `${now.getHours()}:${String(now.getMinutes()).padStart(2,'0')}`,
                endTime: '',
                leads: window.tempSalesData.leads,
                result: window.tempSalesData.result,
                note: window.tempSalesData.note
            };
            visitHistoryData.unshift(newVisit);

            setTimeout(() => {
                addBotMsg("ê¸°ë¡ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ë§ˆì´í˜ì´ì§€ì—ì„œ í™•ì¸í•´ë³´ì„¸ìš”! âœ…");
                setTimeout(() => {
                    goToPage('mypage');
                }, 1500);
            }, 600);
        };

        submitBtn.onclick = () => complete(textInput.value.trim());
        textInput.onkeypress = (e) => { if(e.key === 'Enter') submitBtn.click(); };

        inputWrapper.appendChild(textInput);
        inputWrapper.appendChild(submitBtn);
        chipBox.appendChild(inputWrapper);

        // ì—†ìŒ ë²„íŠ¼
        const skipBtn = document.createElement('div');
        skipBtn.className = 'chip';
        skipBtn.innerText = 'ì—†ìŒ';
        skipBtn.style.marginTop = '8px';
        skipBtn.style.display = 'inline-block';
        skipBtn.onclick = () => complete('');
        chipBox.appendChild(skipBtn);

        setTimeout(() => textInput.focus(), 100);
    }

    // --- í™œë™ ì¶”ì²œ ì‹œë‚˜ë¦¬ì˜¤ ---
    function startRecommendFlow() {
        setTimeout(() => {
            addBotMsg("ì˜¤ëŠ˜ í™œë™í•  ì¥ì†Œë¥¼ ì¶”ì²œí•´ë“œë¦´ê²Œìš”! ğŸ—ºï¸<br>ì–´ë–¤ ìœ í˜•ì˜ ì¥ì†Œë¥¼ ì›í•˜ì‹œë‚˜ìš”?");

            setTimeout(() => {
                const placeTypes = ['ê³µì›/ì•¼ì™¸', 'ì¹´í˜/ì‹ë‹¹', 'ì•„íŒŒíŠ¸/ì£¼ê±°ë‹¨ì§€', 'ê¸°íƒ€'];
                setChips(placeTypes, (selected) => {
                    addUserMsg(selected);

                    setTimeout(() => {
                        const recommendations = {
                            'ê³µì›/ì•¼ì™¸': { name: 'íš¨ì›ê³µì›', icon: 'ğŸŒ²', reason: 'ì£¼ë§ ê°€ì¡± ë‹¨ìœ„ ë°©ë¬¸ê°ì´ ë§ì•„ìš”' },
                            'ì¹´í˜/ì‹ë‹¹': { name: 'ë¸ŒëŸ°ì¹˜ ë¹ˆ', icon: 'â˜•', reason: 'ì§ì¥ì¸ ì ì‹¬ì‹œê°„ì— ìœ ë™ì¸êµ¬ê°€ ë§ì•„ìš”' },
                            'ì•„íŒŒíŠ¸/ì£¼ê±°ë‹¨ì§€': { name: 'ì•„ì´íŒŒí¬ ìºìŠ¬', icon: 'ğŸ¢', reason: 'ì‹ ê·œ ì…ì£¼ ê°€êµ¬ê°€ ë§ì€ ë‹¨ì§€ì˜ˆìš”' },
                            'ê¸°íƒ€': { name: 'íŒíƒ€ì§€ì›€', icon: 'ğŸ°', reason: 'ì£¼ë§ ê°€ì¡± ë°©ë¬¸ê°ì´ ë§ì€ í‚¤ì¦ˆì¹´í˜ì˜ˆìš”' }
                        };

                        const rec = recommendations[selected] || recommendations['ê¸°íƒ€'];
                        addBotMsg(`<strong>${rec.icon} ${rec.name}</strong>ì„ ì¶”ì²œë“œë ¤ìš”!<br><br>ğŸ“Š <strong>ì¶”ì²œ ì´ìœ :</strong> ${rec.reason}<br><br>ì´ ì¥ì†Œë¡œ í™œë™ì„ ì‹œì‘í•˜ì‹œê² ì–´ìš”?`);

                        setTimeout(() => {
                            setChips(['ë„¤, ì¶œë°œí• ê²Œìš”!', 'ë‹¤ë¥¸ ì¥ì†Œ ì¶”ì²œ'], (choice) => {
                                addUserMsg(choice);
                                if (choice === 'ë„¤, ì¶œë°œí• ê²Œìš”!') {
                                    setTimeout(() => {
                                        addBotMsg("ì¢‹ì•„ìš”! í™”ì´íŒ…ì…ë‹ˆë‹¤! ğŸ’ª<br>í™œë™ í›„ ì„±ê³¼ ë“±ë¡ì„ ìŠì§€ ë§ˆì„¸ìš”~");
                                    }, 500);
                                } else {
                                    startRecommendFlow();
                                }
                            });
                        }, 600);
                    }, 800);
                });
            }, 600);
        }, 500);
    }

    // --- ì§ˆì˜ì‘ë‹µ ì‹œë‚˜ë¦¬ì˜¤ ---
    let qnaCount = 0;
    const MAX_QNA = 3;
    const GEMINI_API_KEY = 'AIzaSyDDGJhiMNYvMJkKQhbdoLl_BqW21ZlfvVY';

    function startQnAFlow() {
        qnaCount = 0; // ì§ˆì˜ì‘ë‹µ ì‹œì‘ ì‹œ ì¹´ìš´íŠ¸ ì´ˆê¸°í™”
        chatInputMode = 'qna'; // ì…ë ¥ ëª¨ë“œë¥¼ ì§ˆì˜ì‘ë‹µìœ¼ë¡œ ì„¤ì •

        setTimeout(() => {
            addBotMsg(`ê¶ê¸ˆí•œ ì ì„ ììœ ë¡­ê²Œ ë¬¼ì–´ë³´ì„¸ìš”! (ìµœëŒ€ ${MAX_QNA}íšŒ)<br><span style="font-size:12px; color:var(--text-caption);">í•˜ë‹¨ ì…ë ¥ì°½ì— ì§ˆë¬¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</span>`);
            document.getElementById('quick-replies').innerHTML = '';
            document.getElementById('chat-input').focus();
        }, 500);
    }

    // ì´ˆê¸° ì˜µì…˜ ë‹¤ì‹œ í‘œì‹œ
    function showInitialOptions() {
        setTimeout(() => {
            const options = ['ì„±ê³¼ ë“±ë¡', 'í™œë™ ì¶”ì²œ', 'ì§ˆì˜ì‘ë‹µ'];
            setChips(options, (val) => {
                addUserMsg(val);
                if (val === 'ì„±ê³¼ ë“±ë¡') {
                    startPerformanceFlow();
                } else if (val === 'í™œë™ ì¶”ì²œ') {
                    startActivityRecommendFlow();
                } else if (val === 'ì§ˆì˜ì‘ë‹µ') {
                    startQnAFlow();
                }
            });
        }, 500);
    }

    // Gemini API í˜¸ì¶œ í•¨ìˆ˜
    async function callGeminiAPI(question) {
        const systemPrompt = `ë‹¹ì‹ ì€ ì˜ì—… í™œë™ì„ ë•ëŠ” AI ì–´ì‹œìŠ¤í„´íŠ¸ LUMIì…ë‹ˆë‹¤.
ì˜ì—… ê´€ë ¨ ì§ˆë¬¸ì— ì¹œì ˆí•˜ê³  ê°„ê²°í•˜ê²Œ ë‹µë³€í•´ì£¼ì„¸ìš”.
ë‹µë³€ì€ 2-3ë¬¸ì¥ìœ¼ë¡œ ì§§ê²Œ í•´ì£¼ì„¸ìš”.
ì˜ì—…, ê³ ê°, ë¦¬ë“œ, ê³„ì•½, í™œë™, ì¥ì†Œ, ì¶”ì²œ, ë§¤ì¶œ, ìƒë‹´, íŒì´‰ ë“± ì˜ì—… ê´€ë ¨ ì§ˆë¬¸ì— ì§‘ì¤‘í•´ì£¼ì„¸ìš”.`;

        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    contents: [{
                        parts: [{
                            text: `${systemPrompt}\n\nì‚¬ìš©ì ì§ˆë¬¸: ${question}`
                        }]
                    }],
                    generationConfig: {
                        temperature: 0.7,
                        maxOutputTokens: 256,
                    }
                })
            });

            const data = await response.json();

            if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                return data.candidates[0].content.parts[0].text;
            } else {
                return "ë‹µë³€ì„ ìƒì„±í•˜ëŠ” ë° ë¬¸ì œê°€ ë°œìƒí–ˆì–´ìš”. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
            }
        } catch (error) {
            console.error('Gemini API Error:', error);
            return "ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´ìš”. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
        }
    }

    // setChips í—¬í¼ í•¨ìˆ˜
    function setChips(labels, callback) {
        const box = document.getElementById('quick-replies');
        box.innerHTML = '';
        labels.forEach(l => {
            const c = document.createElement('div');
            c.className = 'chip';
            c.innerText = l;
            c.onclick = () => callback(l);
            box.appendChild(c);
        });
    }

    // í•˜ë‹¨ ì…ë ¥ë°”ì—ì„œ ë©”ì‹œì§€ ì „ì†¡
    let chatInputMode = 'qna'; // 'qna' | 'note' | 'idle'

    async function sendChatMessage() {
        const input = document.getElementById('chat-input');
        const message = input.value.trim();
        if (!message) return;

        input.value = '';

        // ì§ˆì˜ì‘ë‹µ ëª¨ë“œì¼ ë•Œ
        if (chatInputMode === 'qna') {
            if (qnaCount >= MAX_QNA) {
                addBotMsg("ì§ˆë¬¸ íšŸìˆ˜ë¥¼ ëª¨ë‘ ì‚¬ìš©í–ˆì–´ìš”. ë‹¤ë¥¸ ë©”ë‰´ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!");
                return;
            }

            qnaCount++;
            addUserMsg(message, true);

            // ë‚¨ì€ íšŸìˆ˜ ì—…ë°ì´íŠ¸
            const countEl = document.getElementById('qna-count');
            if (countEl) {
                countEl.innerText = `ë‚¨ì€ ì§ˆë¬¸: ${MAX_QNA - qnaCount}íšŒ`;
            }

            // Gemini API í˜¸ì¶œ
            try {
                const response = await callGeminiAPI(message);
                addBotMsg(response);
            } catch (error) {
                addBotMsg("ì£„ì†¡í•´ìš”, ë‹µë³€ì„ ê°€ì ¸ì˜¤ëŠ” ë° ë¬¸ì œê°€ ë°œìƒí–ˆì–´ìš”.");
            }

            // 3íšŒ ë‹¤ ì‚¬ìš©í–ˆìœ¼ë©´ ì¢…ë£Œ
            if (qnaCount >= MAX_QNA) {
                setTimeout(() => {
                    addBotMsg("ì§ˆë¬¸ íšŸìˆ˜ë¥¼ ëª¨ë‘ ì‚¬ìš©í–ˆì–´ìš”. ë‹¤ë¥¸ ë„ì›€ì´ í•„ìš”í•˜ì‹œë©´ ë§ì”€í•´ì£¼ì„¸ìš”!");
                    chatInputMode = 'idle';
                    showInitialOptions();
                }, 1000);
            }
        } else {
            // ì¼ë°˜ ë©”ì‹œì§€ (ì§ˆì˜ì‘ë‹µ ìë™ ì‹œì‘)
            addUserMsg(message);
            chatInputMode = 'qna';
            qnaCount = 0;

            try {
                const response = await callGeminiAPI(message);
                addBotMsg(response);
                qnaCount = 1;

                // ë‚¨ì€ íšŸìˆ˜ í‘œì‹œ
                addBotMsg(`<span style="font-size:12px; color:var(--text-caption);">ë‚¨ì€ ì§ˆë¬¸: ${MAX_QNA - qnaCount}íšŒ</span>`);
            } catch (error) {
                addBotMsg("ì£„ì†¡í•´ìš”, ë‹µë³€ì„ ê°€ì ¸ì˜¤ëŠ” ë° ë¬¸ì œê°€ ë°œìƒí–ˆì–´ìš”.");
            }
        }
    }

    // ì—”í„°í‚¤ë¡œ ë©”ì‹œì§€ ì „ì†¡
    document.addEventListener('DOMContentLoaded', function() {
        const chatInput = document.getElementById('chat-input');
        if (chatInput) {
            chatInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendChatMessage();
                }
            });
        }
    });

    // í”Œë¡œíŒ… ë²„íŠ¼ì—ì„œ ì±—ë´‡ ì§„ì… (LUMI)
    function openChatBot() {
        // goToPage('chat')ì´ initChat()ì„ í˜¸ì¶œí•˜ë¯€ë¡œ ê·¸ëƒ¥ í˜ì´ì§€ ì´ë™ë§Œ í•˜ë©´ ë¨
        goToPage('chat');
    }

    // --- [NEW] ì˜¤ëŠ˜ í™œë™ ì™„ë£Œ ë¦¬í¬íŠ¸ ---
    function showDailyReport() {
        const reportPage = document.getElementById('page-finish');
        const floatingBtn = document.querySelector('.floating-chat-btn');

        // 1. ë¦¬í¬íŠ¸ í˜ì´ì§€ í‘œì‹œ
        reportPage.style.display = 'flex';

        // 2. í”Œë¡œíŒ… ë²„íŠ¼ ìˆ¨ê¹€
        if (floatingBtn) floatingBtn.style.display = 'none';

        // 3. ìˆœì°¨ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
        const lumiContainer = reportPage.querySelector('.lumi-container');
        const line1 = reportPage.querySelector('.line-1');
        const line2 = reportPage.querySelector('.line-2');
        const line3 = reportPage.querySelector('.line-3');
        const line4 = reportPage.querySelector('.line-4');
        const line5 = reportPage.querySelector('.line-5');
        const closeBtn = reportPage.querySelector('.btn-close-report');

        // LUMI ë“±ì¥ (0.1s)
        setTimeout(() => {
            lumiContainer.style.opacity = '1';
            lumiContainer.style.transform = 'translateY(0)';
            lumiContainer.style.transition = 'all 0.6s ease-out';
        }, 100);

        // íƒ€ì´í‹€ (0.8s)
        setTimeout(() => {
            line1.style.display = 'block';
            line1.classList.add('fade-in-up');
        }, 800);

        // ì„±ê³¼ ë°•ìŠ¤ (1.8s)
        setTimeout(() => {
            line2.style.display = 'block';
            line2.classList.add('fade-in-up');
        }, 1800);

        // ì¹­ì°¬ ë©˜íŠ¸ (3.0s)
        setTimeout(() => {
            line3.style.display = 'block';
            line3.classList.add('fade-in-up');
        }, 3000);

        // ë‚´ì¼ ì¶”ì²œ (4.2s)
        setTimeout(() => {
            line4.style.display = 'block';
            line4.classList.add('fade-in-up');
        }, 4200);

        // ë§ˆë¬´ë¦¬ ì¸ì‚¬ (5.2s)
        setTimeout(() => {
            line5.style.display = 'block';
            line5.classList.add('fade-in-up');
        }, 5200);

        // ë‹«ê¸° ë²„íŠ¼ (6.0s)
        setTimeout(() => {
            closeBtn.style.display = 'inline-block';
            closeBtn.classList.add('fade-in-up');
        }, 6000);
    }

    function closeDailyReport() {
        const reportPage = document.getElementById('page-finish');
        const floatingBtn = document.querySelector('.floating-chat-btn');

        // 1. ë¦¬í¬íŠ¸ í˜ì´ì§€ ìˆ¨ê¹€
        reportPage.style.display = 'none';

        // 2. í”Œë¡œíŒ… ë²„íŠ¼ ë‹¤ì‹œ í‘œì‹œ
        if (floatingBtn) floatingBtn.style.display = 'block';

        // 3. ìš”ì†Œë“¤ ì´ˆê¸°í™” (ë‹¤ìŒ ì‹¤í–‰ì„ ìœ„í•´)
        const lumiContainer = reportPage.querySelector('.lumi-container');
        const lines = reportPage.querySelectorAll('.report-line, .report-box');
        const closeBtn = reportPage.querySelector('.btn-close-report');

        lumiContainer.style.opacity = '0';
        lumiContainer.style.transform = 'translateY(20px)';
        lumiContainer.style.transition = 'none';

        lines.forEach(el => {
            el.style.display = 'none';
            el.classList.remove('fade-in-up');
        });

        closeBtn.style.display = 'none';
        closeBtn.classList.remove('fade-in-up');
    }

    // í™œë™ GO!ì—ì„œ ì§„ì…í•˜ëŠ” ì±—ë´‡
    function initSalesChat() {
        const chatBox = document.getElementById('chat-box');
        chatBox.innerHTML = ''; // ì´ˆê¸°í™”
        document.getElementById('quick-replies').innerHTML = '';

        const placeName = window.currentSalesPlace?.name || 'í˜„ì¬ ì¥ì†Œ';
        const placeIcon = window.currentSalesPlace?.icon || 'ğŸ“';

        // ì•„ì´ì½˜ ìƒ‰ìƒ ë§¤í•‘
        const iconColorMap = {
            'ğŸŒ²': { bg: '#E8F5E9', color: '#4CAF50' },
            'ğŸ°': { bg: '#FFF3E0', color: '#FF9800' },
            'ğŸšŒ': { bg: '#E3F2FD', color: '#2196F3' },
            'ğŸ“š': { bg: '#F3E5F5', color: '#9C27B0' },
            'â˜•': { bg: '#FBE9E7', color: '#FF5722' },
            'ğŸ«': { bg: '#FFF3E0', color: '#FF9800' },
            'ğŸ¢': { bg: '#E0E0E0', color: '#757575' },
            'ğŸ“': { bg: '#E0E0E0', color: '#757575' }
        };
        const iconStyle = iconColorMap[placeIcon] || { bg: '#E0E0E0', color: '#757575' };

        // ì„ì‹œ ë°ì´í„° ì´ˆê¸°í™”
        window.tempSalesData = {
            placeName: placeName,
            icon: placeIcon,
            iconBg: iconStyle.bg,
            iconColor: iconStyle.color,
            leads: 0,
            result: 'none',
            note: ''
        };

        addBotMsg(`<strong>${placeName}</strong>ì—ì„œ ì˜ì—… í™œë™ì„ ì‹œì‘í•˜ì…¨êµ°ìš”! ğŸ’ª<br><br>ì˜¤ëŠ˜ ë§Œë‚œ <strong>ë¦¬ë“œ(ê°€ë§ê³ ê°)</strong>ëŠ” ëª‡ ë¶„ì´ì‹ ê°€ìš”?`);
        setTimeout(() => {
            startLeadQuestionChipsOnly();
        }, 600);
    }

    // ë¦¬ë“œ ì§ˆë¬¸ ì¹©ë§Œ í‘œì‹œ (ë©”ì‹œì§€ ì—†ì´ - í™œë™ GO!ì—ì„œ ì‚¬ìš©)
    function startLeadQuestionChipsOnly() {
        const chipBox = document.getElementById('quick-replies');
        chipBox.innerHTML = '';

        const leadOptions = ['0ëª…', '1ëª…', '2ëª…', '3ëª…', '4ëª…', '5ëª…', '6ëª… ì´ìƒ'];

        leadOptions.forEach(option => {
            const btn = document.createElement('div');
            btn.className = 'chip';
            btn.innerText = option;
            btn.onclick = () => {
                addUserMsg(option);

                if (option === '6ëª… ì´ìƒ') {
                    window.tempSalesData.leads = 6;
                } else {
                    window.tempSalesData.leads = parseInt(option);
                }

                chipBox.innerHTML = '';

                setTimeout(() => {
                    startResultQuestionFromSales();
                }, 600);
            };
            chipBox.appendChild(btn);
        });
    }

    // ë¦¬ë“œ ìˆ˜ ì§ˆë¬¸ë§Œ í‘œì‹œ (í™œë™ GO!ì—ì„œ ì‚¬ìš©)
    function startResultQuestionFromSales() {
        addBotMsg("ê³ ìƒí•˜ì…¨ìŠµë‹ˆë‹¤! í˜¹ì‹œ <strong>ê³„ì•½ ì„±ê³¼</strong>ë„ ìˆì—ˆë‚˜ìš”? ğŸ‰");
        const resultOptions = ['ì—†ìŒ', 'ì†ŒìŠ¤ë§Œ í™•ë³´', 'ê³„ì•½ ì„±ê³µ!'];
        setChips(resultOptions, (val) => {
            addUserMsg(val);
            if(val === 'ì—†ìŒ') window.tempSalesData.result = 'none';
            else if(val === 'ì†ŒìŠ¤ë§Œ í™•ë³´') window.tempSalesData.result = 'source';
            else window.tempSalesData.result = 'success';

            setTimeout(() => askNoteFromSales(), 600);
        });
    }

    // íŠ¹ì´ì‚¬í•­ ì§ˆë¬¸ (í™œë™ GO!ì—ì„œ ì‚¬ìš©)
    function askNoteFromSales() {
        addBotMsg("ê·¸ëŸ¼ ê¸°íƒ€ íŠ¹ì´ì‚¬í•­ì€ ìˆì—ˆë‚˜ìš”? ğŸ“<br><span style='font-size:13px; color:var(--text-caption);'>(ì˜ˆ: íŒì´‰ë¬¼ í•„ìš” ì—¬ë¶€, ê´€ë ¨ ë‹´ë‹¹ì ì‘ëŒ€ ë°©ë²•)</span>");

        const chipBox = document.getElementById('quick-replies');
        chipBox.innerHTML = '';

        const inputWrapper = document.createElement('div');
        inputWrapper.style.cssText = 'display:flex; gap:8px; width:100%; margin-top:8px;';

        const textInput = document.createElement('input');
        textInput.type = 'text';
        textInput.placeholder = 'íŠ¹ì´ì‚¬í•­ ì…ë ¥...';
        textInput.style.cssText = 'flex:1; padding:12px 16px; border:2px solid #E0E0E0; border-radius:14px; font-size:14px; font-family:inherit;';

        const submitBtn = document.createElement('button');
        submitBtn.innerText = 'ì™„ë£Œ';
        submitBtn.style.cssText = 'padding:12px 20px; background:var(--primary); color:white; border:none; border-radius:14px; font-size:14px; font-weight:600; cursor:pointer;';

        const complete = (text) => {
            window.tempSalesData.note = text;
            addUserMsg(text || 'ì—†ìŒ');
            chipBox.innerHTML = '';

            // ë°ì´í„° ì €ì¥
            const now = new Date();
            const newVisit = {
                id: visitHistoryData.length,
                name: window.tempSalesData.placeName,
                icon: window.tempSalesData.icon,
                iconBg: window.tempSalesData.iconBg,
                iconColor: window.tempSalesData.iconColor,
                date: now.toISOString().split('T')[0],
                startTime: `${now.getHours()}:${String(now.getMinutes()).padStart(2,'0')}`,
                endTime: '',
                leads: window.tempSalesData.leads,
                result: window.tempSalesData.result,
                note: window.tempSalesData.note
            };
            visitHistoryData.unshift(newVisit);
            addNewHistoryCard(newVisit, 0);

            setTimeout(() => {
                addBotMsg("ê¸°ë¡ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ë§ˆì´í˜ì´ì§€ì—ì„œ í™•ì¸í•´ë³´ì„¸ìš”! âœ…");
                setTimeout(() => {
                    goToVisitResult(0);
                }, 1000);
            }, 600);
        };

        submitBtn.onclick = () => complete(textInput.value.trim());
        textInput.onkeypress = (e) => { if(e.key === 'Enter') submitBtn.click(); };

        inputWrapper.appendChild(textInput);
        inputWrapper.appendChild(submitBtn);
        chipBox.appendChild(inputWrapper);

        const skipBtn = document.createElement('div');
        skipBtn.className = 'chip';
        skipBtn.innerText = 'ì—†ìŒ';
        skipBtn.style.marginTop = '8px';
        skipBtn.style.display = 'inline-block';
        skipBtn.onclick = () => complete('');
        chipBox.appendChild(skipBtn);

        setTimeout(() => textInput.focus(), 100);
    }

    function addBotMsg(html) {
        const box = document.getElementById('chat-box');
        box.innerHTML += `<div class="chat-bubble bot">${html}</div>`;
        box.scrollTop = box.scrollHeight;
    }

    function addUserMsg(text, keepInput = false) {
        const box = document.getElementById('chat-box');
        box.innerHTML += `<div class="chat-bubble user">${text}</div>`;
        if (!keepInput) {
            document.getElementById('quick-replies').innerHTML = ''; // ì¹© ì œê±°
        }
        box.scrollTop = box.scrollHeight;
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ëœë¤ í•«ìŠ¤íŒŸ ì„¤ì •
    window.addEventListener('DOMContentLoaded', function() {
        updateRandomHotspot();
    });

    // ========================================
    // ë°©ë¬¸ ê²°ê³¼ ìƒì„¸ í˜ì´ì§€ ê´€ë ¨ ê¸°ëŠ¥
    // ========================================

    // ìƒ˜í”Œ ë°©ë¬¸ ì´ë ¥ ë°ì´í„°
    const visitHistoryData = [
        {
            id: 0,
            name: 'í‘¸ë¥¸ì†” ê³µì›',
            icon: 'ğŸŒ²',
            iconBg: '#E8F5E9',
            iconColor: '#4CAF50',
            date: '2024-11-24',
            startTime: '14:00',
            endTime: '16:30',
            leads: 3,
            result: 'source', // none, source, success
            note: 'ì•„ì´ ë‘ ëª… ì—„ë§ˆ, êµìœ¡ì— ê´€ì‹¬ ë§ìŒ.\në‹¤ìŒì£¼ ìƒë‹´ ì˜ˆì •.'
        },
        {
            id: 1,
            name: 'ê¿ˆë‚˜ë¬´ ìœ ì¹˜ì›',
            icon: 'ğŸ«',
            iconBg: '#FFF3E0',
            iconColor: '#FF9800',
            date: '2024-11-23',
            startTime: '10:00',
            endTime: '12:00',
            leads: 2,
            result: 'none',
            note: 'í•˜ì› ì‹œê°„ì— ë§ì¶° ë°©ë¬¸.\ní•™ë¶€ëª¨ ë¶„ìœ„ê¸° ì¢‹ìŒ.'
        },
        {
            id: 2,
            name: 'ë§í¬ ê¸€ë¹› ë„ì„œê´€',
            icon: 'ğŸ“š',
            iconBg: '#F3E5F5',
            iconColor: '#9C27B0',
            date: '2024-11-22',
            startTime: '15:00',
            endTime: '17:00',
            leads: 1,
            result: 'success',
            note: 'ì´ˆë“±ìƒ ì—„ë§ˆ ê³„ì•½ ì„±ê³µ!\nì˜ì–´ í•™ìŠµì§€ íŒ¨í‚¤ì§€.'
        }
    ];

    // í˜„ì¬ ì„ íƒëœ ë°©ë¬¸ ì´ë ¥ ì¸ë±ìŠ¤
    let currentVisitIndex = 0;
    let selectedResultValue = 'none';

    // ë°©ë¬¸ ê²°ê³¼ ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™
    function goToVisitResult(index) {
        currentVisitIndex = index;
        const visit = visitHistoryData[index];

        // í—¤ë” ì—…ë°ì´íŠ¸
        document.getElementById('visit-result-icon').textContent = visit.icon;
        document.getElementById('visit-result-title').textContent = visit.name;

        // ë‚ ì§œ/ì‹œê°„ ì—…ë°ì´íŠ¸
        const dateObj = new Date(visit.date);
        const dateStr = `${dateObj.getFullYear()}ë…„ ${dateObj.getMonth() + 1}ì›” ${dateObj.getDate()}ì¼`;
        document.getElementById('visit-date').textContent = dateStr;
        document.getElementById('visit-time').textContent = `${visit.startTime} ~ ${visit.endTime}`;

        // ë¦¬ë“œ ì—…ë°ì´íŠ¸
        document.getElementById('visit-leads').textContent = visit.leads + 'ëª…';

        // ê²°ê³¼ ì—…ë°ì´íŠ¸
        updateResultStatus(visit.result);

        // ë¹„ê³  ì—…ë°ì´íŠ¸
        document.getElementById('visit-note').textContent = visit.note || 'ë©”ëª¨ ì—†ìŒ';

        // í˜ì´ì§€ ì „í™˜
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById('page-visit-result').classList.add('active');
    }

    // ê²°ê³¼ ìƒíƒœ UI ì—…ë°ì´íŠ¸
    function updateResultStatus(result) {
        const statusEl = document.getElementById('visit-result-status');
        statusEl.className = 'result-status ' + result;

        const statusText = {
            'none': 'ì—†ìŒ',
            'source': 'ì†ŒìŠ¤ë§Œ í™•ë³´',
            'success': 'ê³„ì•½ ì„±ê³µ'
        };
        statusEl.textContent = statusText[result] || 'ì—†ìŒ';
    }

    // ëª¨ë‹¬ ì—´ê¸°
    function openModal(type) {
        const visit = visitHistoryData[currentVisitIndex];

        if (type === 'datetime') {
            document.getElementById('input-date').value = visit.date;
            document.getElementById('input-start-time').value = visit.startTime;
            document.getElementById('input-end-time').value = visit.endTime;
        } else if (type === 'leads') {
            document.getElementById('input-leads').value = visit.leads;
        } else if (type === 'result') {
            selectedResultValue = visit.result;
            // ì„ íƒ ìƒíƒœ ì´ˆê¸°í™”
            document.querySelectorAll('.result-option').forEach(opt => {
                opt.classList.remove('selected');
                if (opt.dataset.value === visit.result) {
                    opt.classList.add('selected');
                }
            });
        } else if (type === 'note') {
            document.getElementById('input-note').value = visit.note || '';
        }

        document.getElementById('modal-' + type).classList.add('active');
    }

    // ëª¨ë‹¬ ë‹«ê¸°
    function closeModal(type) {
        document.getElementById('modal-' + type).classList.remove('active');
    }

    // ì˜¤ë²„ë ˆì´ í´ë¦­ ì‹œ ëª¨ë‹¬ ë‹«ê¸°
    function closeModalOnOverlay(event, type) {
        if (event.target.classList.contains('modal-overlay')) {
            closeModal(type);
        }
    }

    // ë‚ ì§œ/ì‹œê°„ ì €ì¥
    function saveDatetime() {
        const visit = visitHistoryData[currentVisitIndex];
        visit.date = document.getElementById('input-date').value;
        visit.startTime = document.getElementById('input-start-time').value;
        visit.endTime = document.getElementById('input-end-time').value;

        // UI ì—…ë°ì´íŠ¸
        const dateObj = new Date(visit.date);
        const dateStr = `${dateObj.getFullYear()}ë…„ ${dateObj.getMonth() + 1}ì›” ${dateObj.getDate()}ì¼`;
        document.getElementById('visit-date').textContent = dateStr;
        document.getElementById('visit-time').textContent = `${visit.startTime} ~ ${visit.endTime}`;

        closeModal('datetime');
    }

    // ë¦¬ë“œ ì €ì¥
    function saveLeads() {
        const visit = visitHistoryData[currentVisitIndex];
        visit.leads = parseInt(document.getElementById('input-leads').value) || 0;

        // UI ì—…ë°ì´íŠ¸
        document.getElementById('visit-leads').textContent = visit.leads + 'ëª…';

        // ë§ˆì´í˜ì´ì§€ ì´ë ¥ ì¹´ë“œë„ ì—…ë°ì´íŠ¸
        updateHistoryCard(currentVisitIndex);

        closeModal('leads');
    }

    // ê²°ê³¼ ì˜µì…˜ ì„ íƒ
    function selectResultOption(element) {
        document.querySelectorAll('.result-option').forEach(opt => opt.classList.remove('selected'));
        element.classList.add('selected');
        selectedResultValue = element.dataset.value;
    }

    // ê²°ê³¼ ì €ì¥
    function saveResult() {
        const visit = visitHistoryData[currentVisitIndex];
        visit.result = selectedResultValue;

        // UI ì—…ë°ì´íŠ¸
        updateResultStatus(visit.result);

        closeModal('result');
    }

    // ë¹„ê³  ì €ì¥
    function saveNote() {
        const visit = visitHistoryData[currentVisitIndex];
        visit.note = document.getElementById('input-note').value;

        // UI ì—…ë°ì´íŠ¸
        document.getElementById('visit-note').textContent = visit.note || 'ë©”ëª¨ ì—†ìŒ';

        closeModal('note');
    }

    // ë§ˆì´í˜ì´ì§€ ì´ë ¥ ì¹´ë“œ ì—…ë°ì´íŠ¸
    function updateHistoryCard(index) {
        const visit = visitHistoryData[index];
        const historyCards = document.querySelectorAll('#history-list .history-card');

        if (historyCards[index]) {
            const timeEl = historyCards[index].querySelector('.place-time');
            const daysAgo = getDaysAgo(visit.date);
            timeEl.textContent = `${daysAgo} Â· ë¦¬ë“œ ${visit.leads}ëª…`;
        }
    }

    // ë©°ì¹  ì „ì¸ì§€ ê³„ì‚°
    function getDaysAgo(dateStr) {
        const visitDate = new Date(dateStr);
        const today = new Date();
        const diffTime = today - visitDate;
        const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

        if (diffDays === 0) return 'ì˜¤ëŠ˜ ë°©ë¬¸';
        if (diffDays === 1) return 'ì–´ì œ ë°©ë¬¸';
        return `${diffDays}ì¼ ì „ ë°©ë¬¸`;
    }

    // í™œë™ GO! - ì±—ë´‡ ì„±ê³¼ ì…ë ¥ í˜ì´ì§€ë¡œ ì´ë™
    function startSalesActivity() {
        if (!window.currentPlace) {
            alert('ì¥ì†Œë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.');
            return;
        }

        const detail = placeDetails[window.currentPlace];
        if (!detail) return;

        // í˜„ì¬ ì¥ì†Œ ì •ë³´ ì €ì¥
        window.currentSalesPlace = {
            name: detail.name,
            icon: detail.icon
        };

        // ì±—ë´‡ í—¤ë”ì— ì¥ì†Œëª… í‘œì‹œ
        document.getElementById('chat-place-name').textContent = detail.name + ' ì„±ê³¼ ì…ë ¥';

        // initChat ìŠ¤í‚µ í”Œë˜ê·¸ ì„¤ì •
        window.skipInitChat = true;

        // ì±—ë´‡ í˜ì´ì§€ë¡œ ì´ë™í•˜ê³  ëŒ€í™” ì‹œì‘
        goToPage('chat');
        initSalesChat();
    }

    // ë§ˆì´í˜ì´ì§€ì— ìƒˆ ì´ë ¥ ì¹´ë“œ ì¶”ê°€
    function addNewHistoryCard(visit, index) {
        const historyList = document.getElementById('history-list');
        const newCard = document.createElement('div');
        newCard.className = 'place-card history-card';
        newCard.onclick = () => goToVisitResult(index);
        newCard.innerHTML = `
            <div class="place-img" style="background:${visit.iconBg}; color:${visit.iconColor};">${visit.icon}</div>
            <div class="place-info">
                <div class="place-name">${visit.name}</div>
                <div class="place-time" style="color:#999;">ì˜¤ëŠ˜ ë°©ë¬¸ Â· ë¦¬ë“œ ${visit.leads}ëª…</div>
            </div>
            <div class="arrow-icon">â€º</div>
        `;

        // ë§¨ ìœ„ì— ì¶”ê°€
        historyList.insertBefore(newCard, historyList.firstChild);

        // ê¸°ì¡´ ì¹´ë“œë“¤ì˜ onclick ì¸ë±ìŠ¤ ì—…ë°ì´íŠ¸
        updateHistoryCardIndices();
    }

    // ì´ë ¥ ì¹´ë“œ ì¸ë±ìŠ¤ ì—…ë°ì´íŠ¸
    function updateHistoryCardIndices() {
        const cards = document.querySelectorAll('#history-list .history-card');
        cards.forEach((card, idx) => {
            card.onclick = () => goToVisitResult(idx);
        });
    }

    // ìƒˆë¡œ ìƒì„±ëœ ë°©ë¬¸ ê¸°ë¡ ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™ (ë’¤ë¡œê°€ê¸° ì‹œ ë§ˆì´í˜ì´ì§€ë¡œ)
    function goToVisitResultNew(index) {
        currentVisitIndex = index;
        const visit = visitHistoryData[index];

        // í—¤ë” ì—…ë°ì´íŠ¸
        document.getElementById('visit-result-icon').textContent = visit.icon;
        document.getElementById('visit-result-title').textContent = visit.name;

        // ë‚ ì§œ/ì‹œê°„ ì—…ë°ì´íŠ¸
        const dateObj = new Date(visit.date);
        const dateStr = `${dateObj.getFullYear()}ë…„ ${dateObj.getMonth() + 1}ì›” ${dateObj.getDate()}ì¼`;
        document.getElementById('visit-date').textContent = dateStr;
        document.getElementById('visit-time').textContent = visit.endTime
            ? `${visit.startTime} ~ ${visit.endTime}`
            : `${visit.startTime} ~ (ì§„í–‰ ì¤‘)`;

        // ë¦¬ë“œ ì—…ë°ì´íŠ¸
        document.getElementById('visit-leads').textContent = visit.leads + 'ëª…';

        // ê²°ê³¼ ì—…ë°ì´íŠ¸
        updateResultStatus(visit.result);

        // ë¹„ê³  ì—…ë°ì´íŠ¸
        document.getElementById('visit-note').textContent = visit.note || 'ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”';

        // í˜ì´ì§€ ì „í™˜
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById('page-visit-result').classList.add('active');
    }

</script>

</body>
</html>
